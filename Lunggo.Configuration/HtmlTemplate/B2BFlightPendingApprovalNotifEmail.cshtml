@using System.Globalization
@using Lunggo.ApCommon.Constant
@using Lunggo.Framework.Config

<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width" />
</head>
<body style="background-color:#F4F4F4; color:#535353; font-family:arial, helvetica, sans-serif; font-size:12px;">
    <table style="margin-left:auto; margin-right:auto; width:100%; max-width:700px; display:block; background:#ffffff;">
        <thead width="100%">
            <tr width="100%">
                <th width="5%"></th>
                <th colspan="2" width="90%" style="padding-top:30px;">
                    <p style="text-align:right;">
                        <a href="http://travorama.com" style="text-decoration:none;">
                            <img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/travorama-logo-color.png")" alt="Travorama" />
                        </a>
                        <br />
                        <a href="https://www.facebook.com/travorama" style="text-decoration:none;">
                            <img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/email-facebook.jpg")" alt="Travorama on Facebook" />
                        </a>
                        <a href="https://twitter.com/travoramaid" style="text-decoration:none;">
                            <img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/email-twitter.jpg")" alt="Travorama on Twitter" />
                        </a>
                        <a href="https://instagram.com/travorama" style="text-decoration:none;">
                            <img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/email-instagram.jpg")" alt="Travorama on Instagram" />
                        </a>
                    </p>
                </th>
                <th width="5%"></th>
            </tr>
        </thead>
        <tbody width="100%">
            <tr width="100%">
                <td width="5%"></td>
                <td colspan="2" width="90%">

                    <!-- CONTENT  -->

                    <p style="font-size: 12px">Dear <span style="color: #15b1e4">@Model.Reservation.Booker.ApproverName,</span></p>
                    <p style="font-size: 12px">Persetujuan Anda dibutuhkan untuk pegawai Anda melakukan reservasi tiket pesawat/hotel pegawai Anda dengan identitas berikut:</p>

                    <table width="100%" style="margin-bottom: 10px;" cellpadding="0" cellspacing="0">
                        <tr>
                            <td width="10%">
                                <p style="">Nama</p>
                            </td>
                            <td width="1%"><p>:</p></td>
                            <td width="30%">
                                <p style="">@Model.Reservation.Booker.Name</p>
                            </td>
                        </tr>
                        <tr>
                            <td width="10%">
                                <p style="">Jabatan</p>
                            </td>
                            <td width="1%"><p>:</p></td>
                            <td width="30%">
                                <p style="">@Model.Reservation.Booker.Position</p>
                            </td>
                        </tr>
                        <tr>
                            <td width="10%">
                                <p style="">Departemen</p>
                            </td>
                            <td width="1%"><p>:</p></td>
                            <td width="30%">
                                <p style="">@Model.Reservation.Booker.Department</p>
                            </td>
                        </tr>
                        <tr>
                            <td width="10%">
                                <p style="">Cabang</p>
                            </td>
                            <td width="1%"><p>:</p></td>
                            <td width="30%">
                                <p style="">@Model.Reservation.Booker.Branch</p>
                            </td>
                        </tr>
                        <tr>
                            <td width="10%">
                                <p style="">E-mail</p>
                            </td>
                            <td width="1%"><p>:</p></td>
                            <td width="30%">
                                <p style="">@Model.Reservation.Booker.Email</p>
                            </td>
                        </tr>
                        <tr>
                            <td width="10%">
                                <p style="">Keperluan</p>
                            </td>
                            <td width="1%"><p>:</p></td>
                            <td width="30%">
                                <p style="">@Model.Reservation.BookerMessageTitle</p>
                            </td>
                        </tr>
                        <tr>
                            <td width="10%">
                                <p style="">Deskripsi</p>
                            </td>
                            <td width="1%"><p>:</p></td>
                            <td width="30%">
                                <p style="">@Model.Reservation.BookerMessageDescription</p>
                            </td>
                        </tr>
                    </table>

                    <p style="font-size: 12px">Telah melakukan reservasi tiket pesawat/hotel dengan detail sebagai berikut:</p>
                    <table width="100%" style="margin-bottom: 10px;" cellpadding="0" cellspacing="0">
                        <tr>
                            <td>
                                <hr style="border-color: #f5f5f5; " />
                            </td>
                            <td width="5%"></td>
                            <td>
                                <hr style="border-color: #f5f5f5; " />
                            </td>
                        </tr>
                        <tr>
                            <td width="20%">
                                <p style="opacity: 0.5">Maskapai</p>
                                @if (Model.Reservation.Itinerary.Trips.Count > 1)
                                {
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[0].Segments[0].AirlineName (@Model.Reservation.Itinerary.Trips[0].Segments[0].AirlineCode-@Model.Reservation.Itinerary.Trips[0].Segments[0].FlightNumber)</b></p>
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[1].Segments[0].AirlineName (@Model.Reservation.Itinerary.Trips[1].Segments[0].AirlineCode-@Model.Reservation.Itinerary.Trips[1].Segments[0].FlightNumber)</b></p>
                                }
                                else
                                {
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[0].Segments[0].AirlineName (@Model.Reservation.Itinerary.Trips[0].Segments[0].AirlineCode-@Model.Reservation.Itinerary.Trips[0].Segments[0].FlightNumber)</b></p>
                                }
                            </td>
                            <td width="5%"></td>
                            <td width="20%">
                                <p style="opacity: 0.5">Rute</p>
                                @if (Model.Reservation.Itinerary.Trips.Count > 1)
                                {
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[0].OriginAirport - @Model.Reservation.Itinerary.Trips[0].DestinationAirport</b></p>
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[1].OriginAirport - @Model.Reservation.Itinerary.Trips[1].DestinationAirport</b></p>
                                }
                                else
                                {
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[0].OriginAirport - @Model.Reservation.Itinerary.Trips[0].DestinationAirport</b></p>
                                }
                            </td>
                        </tr>
                    </table>
                    <table width="100%" style="margin-bottom: 30px;" cellpadding="0" cellspacing="0">
                        <tr>
                            <td>
                                <hr style="border-color: #f5f5f5; " />
                            </td>
                            <td width="5%"></td>
                            <td>
                                <hr style="border-color: #f5f5f5; " />
                            </td>
                        </tr>
                        <tr>
                            <td width="20%">
                                <p style="opacity: 0.5">Waktu Penerbangan</p>
                                @if (Model.Reservation.Itinerary.Trips.Count > 1)
                                {
                                    var jamBerangkat = Model.Reservation.Itinerary.Trips[0].Segments[0].DepartureTime;
                                    var jamKembali = Model.Reservation.Itinerary.Trips[1].Segments[0].DepartureTime;
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[0].DepartureDate.ToString("dddd", CultureInfo.CreateSpecificCulture("id-ID")), @Model.Reservation.Itinerary.Trips[0].DepartureDate.ToString("dd MMM yyyy", CultureInfo.CreateSpecificCulture("id-ID")) - Pk @jamBerangkat.ToString("HH:mm")</b></p>
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[1].DepartureDate.ToString("dddd", CultureInfo.CreateSpecificCulture("id-ID")), @Model.Reservation.Itinerary.Trips[1].DepartureDate.ToString("dd MMM yyyy", CultureInfo.CreateSpecificCulture("id-ID")) - Pk @jamKembali.ToString("HH:mm")</b></p>
                                }
                                else
                                {
                                    var jamBerangkat = Model.Reservation.Itinerary.Trips[0].Segments[0].DepartureTime;
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[0].DepartureDate.ToString("dddd", CultureInfo.CreateSpecificCulture("id-ID")), @Model.Reservation.Itinerary.Trips[0].DepartureDate.ToString("dd MMM yyyy", CultureInfo.CreateSpecificCulture("id-ID")) - Pk @jamBerangkat.ToString("HH:mm")</b></p>
                                    
                                }
                            </td>
                            <td width="5%"></td>
                            <td width="20%">
                                <p style="opacity: 0.5">Kode Booking Maskpai (PNR)</p>
                                @if (Model.Reservation.Itinerary.Trips.Count > 1)
                                {
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[0].Segments[0].Pnr</b></p>
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[1].Segments[0].Pnr</b></p>
                                }
                                else
                                {
                                    <p style=""><b>@Model.Reservation.Itinerary.Trips[0].Segments[0].Pnr</b></p>
                                }
                            </td>
                        </tr>
                    </table>
                    <table width="100%" cellpadding="0" cellspacing="0" style="border-top: 3px #15b1e4 solid; margin-bottom: 10px; ">
                        <thead>
                            <tr>
                                <th colspan="6" solid=solid style="color: #15b1e4; border-bottom: 3px solid; ">
                                    <p style="color: #15b1e4; text-align: left"><b>Penumpang yang terdaftar :</b></p>
                                </th>
                            </tr>
                        </thead>
                        @{ var i = Model.Reservation.Pax.Count; }
                        @{ var j = 1; }
                        <tr>
                            <td width="18.2%" rowspan="@i">
                                <p style="color: #15b1e4; text-align: right;">Penumpang</p>
                            </td>
                            <td width="11%">
                                <p style="color: #15b1e4; text-align: center;">:</p>
                            </td>
                            <td>
                                <p style="color: #15b1e4; text-align: left;">1. @Model.Reservation.Pax[0].Name</p>
                            </td>
                            <td width="20%"></td>
                            <td width="5%" style="padding-right: 1%;">
                                <hr style="border-color:#15b1e4;" />
                            </td>
                            <td width="7%">
                                @EnumDisplay.PassengerType(Model.Reservation.Pax[0].Type)
                            </td>
                        </tr>
                        @for (int k = 1; k < i; k++)
                        {
                            <tr>
                                <td width="11%">
                                    <p style="color: #15b1e4; text-align: center;">:</p>
                                </td>
                                <td>
                                    <p style="color: #15b1e4; text-align: left;">@(k + 1). @Model.Reservation.Pax[k].Name</p>
                                </td>
                                <td width="20%"></td>
                                <td width="5%" style="padding-right: 1%;">
                                    <hr style="border-color:#15b1e4;" />
                                </td>
                                <td width="7%">
                                    @EnumDisplay.PassengerType(Model.Reservation.Pax[k].Type)
                                </td>
                            </tr>
                        }
                    </table>
                    <hr style="border-color: #15b1e4; border-style: dotted; margin-bottom: 3%;" width="100%" />

                    <p style="font-size: 12px;">Anda dapat menyetujui atau menolak reservasi tersebut dengan mengeklik tombol di bawah ini:</p>
                    <table width="100%" style="margin-bottom: 10px;" cellpadding="0" cellspacing="0">
                        <tr>
                            <td width="50%">
                                <a style="background-color: #ffd632; border: #e9d14d; display: inline-block; margin-left:45%; text-decoration: none; font-family:arial, helvetica, sans-serif; width: 50%; padding-top: 11px; padding-bottom: 11px; text-align: center; font-size: 11px; color: #333333; margin-top: 10px;"
                                   href="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/id/Flight/UpdateReservation?token=" + Model.Token +"&rsvNo=" + Model.Reservation.RsvNo + "&status=approved")" target="_blank"><b>APPROVE</b></a>
                            </td>
                            <td width="50%">
                                <a style="background-color: #ffd632; border: #e9d14d; display: inline-block; text-decoration: none; font-family:arial, helvetica, sans-serif; width: 50%; padding-top: 11px; padding-bottom: 11px; text-align: center; font-size: 11px; color: #333333; margin-top: 10px;"
                                   href="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/id/Flight/UpdateReservation?token=" + Model.Token + "&rsvNo=" + Model.Reservation.RsvNo + "&status=rejected")" target="_blank"><b>REJECT</b></a>
                            </td>
                        </tr>
                    </table>
                    @*<p style="font-size: 12px; margin-top: 20px">Atau Anda dapat melihat reservasi tersebut dengan lebih detail melalui tombol di bawah ini:</p>
                    <a style="background-color: #ffd632; border: #e9d14d; display: inline-block; margin-left:35%; text-decoration: none; font-family:arial, helvetica, sans-serif;
                            width: 30%; padding-top: 11px; padding-bottom: 11px; text-align: center; font-size: 11px; color: #333333; margin-top: 10px;" href="#" target="_blank"><b>ORDER DETAIL</b></a>*@
                </td>
                <td width="5%"></td>
            </tr>
        </tbody>
        <tfoot width="100%">
            <tr>
                <td></td>
                <td style="width: 60%;"><img style="width: 100%;" src="/Assets/images/email/plane-email-bg.jpg" /></td>
                <td style="padding-bottom:40px;">
                    <address style="font-style:normal; float:right; width:240px; margin-right:0; margin-left:auto; font-size:12px;">
                        <h4 style="color:#1daee5; margin-bottom:5px;">PT. Travel Madezy Internasional</h4>
                        <p style="margin-top:0; margin-bottom:5px;">
                            <span style="color:#1daee5;">A.</span> Equity Tower 25th Floor, SCBD lot 9<br />Jl. Jenderal Sudirman Kav.52-53<br />Jakarta 12190
                        </p>
                    </address>
                </td>
                <td></td>
                <td></td>
            </tr>
        </tfoot>
    </table>
</body>
</html>