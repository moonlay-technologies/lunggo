@using System.Globalization
@using Lunggo.ApCommon.Constant
@using Lunggo.Framework.Config
@using Lunggo.ApCommon.Flight.Model
@model Lunggo.ApCommon.Flight.Model.FlightReservationForDisplay
@{
    FlightSegmentForDisplay prevSegment = null;
}


<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width" />
</head>
<body style="background-color:#F4F4F4; color:#535353; font-family:arial, helvetica, sans-serif; font-size:12px;">


    <table style="margin-left:auto; margin-right:auto; width:100%; max-width:700px; display:block; background:#ffffff;">
        <thead width="100%">
            <tr width="100%">
                <th width="5%"></th>
                <th colspan="2" width="90%" style="padding-top:30px;">
                    <p style="text-align:right;">
                        <a href="http://travorama.com" style="text-decoration:none;">
                            <img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/travorama-logo-color.png")" alt="Travorama" />
                        </a>
                        <br />
                        <a href="https://www.facebook.com/travorama" style="text-decoration:none;">
                            <img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/email-facebook.jpg")" alt="Travorama on Facebook" />
                        </a>
                        <a href="https://twitter.com/travoramaid" style="text-decoration:none;">
                            <img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/email-twitter.jpg")" alt="Travorama on Twitter" />
                        </a>
                        <a href="https://instagram.com/travorama" style="text-decoration:none;">
                            <img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/email-instagram.jpg")" alt="Travorama on Instagram" />
                        </a>
                    </p>
                </th>
                <th width="5%"></th>
            </tr>
        </thead>
        <tbody width="100%">
            <tr width="100%">
                <td width="5%"></td>
                <td colspan="2" width="90%">

                    <!-- CONTENT  -->

                    <p>Dear <span style="color: #15b1e4;"> @Model.Contact.Name, </span></p>
                    <p><b>Travorama.com</b> telah mengkonfirmasi pembayaran untuk transaksi berikut :</p>

                    <table width="100%" style="margin-bottom: 20px;" cellpadding="0" cellspacing="0">
                        <tr>
                            <td>
                                <hr style="border-color: #f5f5f5; opacity: 0.2;" />
                            </td>
                            <td width="5%"></td>
                            <td>
                                <hr style="border-color: #f5f5f5; opacity: 0.2;" />
                            </td>
                            <td width="5%"></td>
                            <td>
                                <hr style="border-color: #f5f5f5; opacity: 0.2;" />
                            </td>
                        </tr>
                        <tr>
                            <td width="20%">
                                <p style="">No. Pemesanan</p>
                                <p style=""><b>@Model.RsvNo</b></p>
                            </td>
                            <td width="5%"></td>
                            <td width="20%">
                                <p style="">Waktu.</p>
                                @{ var jamKonfirmasi = Model.Payment.Time.GetValueOrDefault().AddHours(7); }
                                <p style=""><b>@jamKonfirmasi.ToString("dd MMM yy") - Pk @jamKonfirmasi.ToString("HH:mm") WIB</b></p>
                            </td>
                            <td width="5%"></td>
                            <td width="20%">
                                <p style="opacity: 0.5;">Metode Pembayaran</p>
                                <p style=""><b>@EnumDisplay.PaymentMethod(Model.Payment.Method)</b></p>
                            </td>
                        </tr>
                    </table>

                    <table width="100%" cellpadding="0" cellspacing="0" style="border-top: 3px #15b1e4 solid; margin-bottom: 50px; ">
                        <thead>
                            <tr>
                                <th colspan="6" solid=solid style="color: #15b1e4; border-bottom: 3px solid; ">
                                    <p style="color: #15b1e4; text-align: left;"><b>Detail Pemesanan</b></p>
                                </th>
                            </tr>
                        </thead>
                        <tr>
                            <td width="25%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left;">User ID</p>
                            </td>
                            <td width="8%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: center;">:</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left; text-decoration:none;">@Model.Contact.Email</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                        </tr>
                        <tr>
                            <td width="25%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left;">Tanggal Pemesanan</p>
                            </td>
                            <td width="8%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: center;">:</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left;">@Model.RsvTime.ToString("dd MMMM yyyy")</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                        </tr>
                        <tr>
                            <td width="25%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left;">Tipe Pesanan</p>
                            </td>
                            <td width="8%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: center;">:</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left;">Penerbangan</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                        </tr>
                        <tr>
                            <td width="25%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left;">Harga</p>
                            </td>
                            <td width="8%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: center;">:</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left;">Rp @Model.Payment.FinalPrice.ToString("##,###", CultureInfo.CreateSpecificCulture("id-ID"))</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                        </tr>
                        <tr>
                            <td width="25%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left;">Dipesan oleh</p>
                            </td>
                            <td width="8%" style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: center;">:</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; ">
                                <p style="color: #15b1e4; text-align: left;">@Model.Contact.Name</p>
                            </td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                            <td style="color: #15b1e4; border-bottom: 1px solid; "></td>
                        </tr>
                        @{ var i = Model.Passengers.Count; }
                        @{ var j = 1; }
                        <tr>
                            <td width="25%" rowspan="@i">
                                <p style="color: #15b1e4; text-align: left;">Nama Penumpang</p>
                            </td>
                            <td width="8%">
                                <p style="color: #15b1e4; text-align: center;">:</p>
                            </td>
                            <td>
                                <p style="color: #15b1e4; text-align: left;">1. @Model.Passengers[0].Name</p>
                            </td>
                            <td width="20%"></td>
                            <td width="5%" style="padding-right: 1%;">
                                <hr style="border-color:#15b1e4;" />
                            </td>
                            <td width="7%">
                                @EnumDisplay.PassengerType(Model.Passengers[0].Type.GetValueOrDefault())
                            </td>
                        </tr>
                        @for (int k = 1; k < i; k++)
                        {
                            <tr>
                                <td width="8%">
                                    <p style="color: #15b1e4; text-align: center;">:</p>
                                </td>
                                <td>
                                    <p style="color: #15b1e4; text-align: left;">@(k + 1). @Model.Passengers[k].Name</p>
                                </td>
                                <td width="20%"></td>
                                <td width="5%" style="padding-right: 1%;">
                                    <hr style="border-color:#15b1e4;" />
                                </td>
                                <td width="7%">
                                    @EnumDisplay.PassengerType(Model.Passengers[k].Type.GetValueOrDefault())
                                </td>
                            </tr>
                        }
                    </table>
                    <table width="100%" cellpadding="0" cellspacing="0" style="border-top: 3px #15b1e4 solid; margin-bottom: 30px; ">
                        <thead>
                            <tr>
                                <th colspan="6" solid=solid style="color: #15b1e4; border-bottom: 3px solid; ">
                                    <p style="color: #15b1e4; text-align: left"><b>Detail Penerbangan</b></p>
                                </th>
                            </tr>
                        </thead>
                    </table>
                    <p><img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/email/flight-departure-icon.png")" /> <b>BERANGKAT</b></p>
                    @foreach (var segment in Model.Itinerary.Trips[0].Segments)
                    {
                        if (segment != Model.Itinerary.Trips[0].Segments.First())
                        {
                            var transitDuration = segment.DepartureTime - prevSegment.ArrivalTime;
                            <p style="width:100%; text-align:center;border-bottom:1px dashed #15b1e4; line-height:0.3em;margin:10px 0 20px;"><span style="background:#fff;padding:0 10px;color:#15b1e4;">Lama Transit : @transitDuration.ToString()</span></p>
                        }
                        <table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:20px;">
                            <tbody>
                                <tr>
                                    <td width="15%" rowspan="3"><img src="@segment.AirlineLogoUrl" width="40%" alt="@segment.AirlineName" class="flight-airline" /></td>
                                    <td width="4%" rowspan="4"></td>
                                    <td width="25%">@segment.DepartureTime.GetValueOrDefault().ToString("dd MMM yyyy", CultureInfo.CreateSpecificCulture("id-ID"))</td>
                                    <td width="3" rowspan="4"></td>
                                    <td width="25%" rowspan="4"><p style="border-bottom:3px solid #15b1e4;padding-bottom:5px; text-align:center;"><b>Durasi:</b> @TimeSpan.FromMilliseconds(segment.Duration.GetValueOrDefault()).ToString(@"h'j 'm'm'")</p></td>
                                    <td width="3" rowspan="4"></td>
                                    <td width="25%">@segment.ArrivalTime.GetValueOrDefault().ToString("dd MMM yyyy", CultureInfo.CreateSpecificCulture("id-ID"))</td>
                                </tr>
                                <tr>
                                    <td width="25%"><b>@segment.DepartureTime.GetValueOrDefault().ToString("HH:mm")</b></td>
                                    <td width="25%"><b>@segment.ArrivalTime.GetValueOrDefault().ToString("HH:mm")</b></td>
                                </tr>
                                <tr>
                                    <td width="25%"><b>@segment.DepartureCity (@segment.DepartureAirport)</b></td>
                                    <td width="25%"><b>@segment.ArrivalCity (@segment.ArrivalAirport)</b></td>
                                </tr>
                                <tr>
                                    <td width="15%"><span style="color: #15b1e4;">@segment.AirlineName</span></td>
                                    <td width="25%">@segment.DepartureAirportName</td>
                                    <td width="25%">@segment.ArrivalAirportName</td>
                                </tr>
                            </tbody>
                        </table>
                        prevSegment = segment;
                    }
                </td>
                <td width="5%"></td>
            </tr>
            @if (Model.Itinerary.Trips.Count > 1)
            {
                <tr>
                    <td width="5%" style="padding-top:20px;"></td>
                    <td colspan="2" width="90%" style="padding-top:20px;">
                        <p><img src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/email/flight-return-icon.png")" /> <b>KEMBALI</b></p>
                        @foreach (var segment in Model.Itinerary.Trips[1].Segments)
                        {
                            if (segment != Model.Itinerary.Trips[1].Segments.First())
                            {
                                var transitDuration = segment.DepartureTime - prevSegment.ArrivalTime;
                                <p style="width:100%; text-align:center;border-bottom:1px dashed #15b1e4; line-height:0.3em;margin:10px 0 20px;"><span style="background:#fff;padding:0 10px;color:#15b1e4;">Lama Transit : @transitDuration.ToString()</span></p>
                            }
                            <table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:20px;">
                                <tbody>
                                    <tr>
                                        <td width="15%" rowspan="3"><img src="@segment.AirlineLogoUrl" width="40%" alt="@segment.AirlineName" class="flight-airline" /></td>
                                        <td width="4%" rowspan="4"></td>
                                        <td width="25%">@segment.DepartureTime.GetValueOrDefault().ToString("dd MMM yyyy", CultureInfo.CreateSpecificCulture("id-ID"))</td>
                                        <td width="3" rowspan="4"></td>
                                        <td width="25%" rowspan="4"><p style="border-bottom:3px solid #15b1e4;padding-bottom:5px; text-align:center;"><b>Durasi:</b> @TimeSpan.FromMilliseconds(segment.Duration.GetValueOrDefault()).ToString(@"h'j 'm'm'")</p></td>
                                        <td width="3" rowspan="4"></td>
                                        <td width="25%">@segment.ArrivalTime.GetValueOrDefault().ToString("dd MMM yyyy", CultureInfo.CreateSpecificCulture("id-ID"))</td>
                                    </tr>
                                    <tr>
                                        <td width="25%"><b>@segment.DepartureTime.GetValueOrDefault().ToString("HH:mm")</b></td>
                                        <td width="25%"><b>@segment.ArrivalTime.GetValueOrDefault().ToString("HH:mm")</b></td>
                                    </tr>
                                    <tr>
                                        <td width="25%"><b>@segment.DepartureCity (@segment.DepartureAirport)</b></td>
                                        <td width="25%"><b>@segment.ArrivalCity (@segment.ArrivalAirport)</b></td>
                                    </tr>
                                    <tr>
                                        <td width="15%"><span style="color: #15b1e4;">@segment.AirlineName</span></td>
                                        <td width="25%">@segment.DepartureAirportName</td>
                                        <td width="25%">@segment.ArrivalAirportName</td>
                                    </tr>
                                </tbody>
                            </table>
                            prevSegment = segment;
                        }
                    </td>
                    <td width="5%" style="padding-top:20px;"></td>
                </tr>
            }
            <tr>
                <td width="5%" style="padding-top:20px;"></td>
                <td colspan="2" width="90%" style="padding-top:20px;">
                    @{ var jamMaxEtiket = Model.Payment.Time.GetValueOrDefault().AddHours(9); }

                    @*<p>Kuitansi pembayaran Anda telah disertakan sebagai attachment.</p>*@
                    <p>
                        E-tiket Anda akan dikirimkan secara otomatis ke e-mail Anda maksimal <span style="color: #15b1e4;">@jamMaxEtiket.ToString("dd MMMM yyyy", CultureInfo.CreateSpecificCulture("id-ID")) </span>,  pukul <span style="color: #15b1e4;"> @jamMaxEtiket.ToString("HH:mm") WIB</span> , jika sampai saat tersebut Anda belum menerima e-tiket, mohon hubungi kami melalui e-mail <span style="color: #15b1e4;">cs@travorama.com.</span>

                    </p>
                </td>
                <td width="5%" style="padding-top:20px;"></td>
            </tr>
        </tbody>
        <tfoot width="100%">
            <tr>
                <td></td>
                <td style="width: 60%;"><img style="width: 100%;" src="@(ConfigManager.GetInstance().GetConfigValue("general", "rootUrl") + @"/Assets/images/email/plane-email-bg.jpg")" /></td>
                <td style="padding-bottom:40px;">

                    <address style="font-style:normal; float:right; width:240px; margin-right:0; margin-left:auto; font-size:12px;">

                        <h4 style="color:#1daee5; margin-bottom:5px;">PT. Travel Madezy Internasional</h4>
                        <p style="margin-top:0; margin-bottom:5px;">
                            <span style="color:#1daee5;">A.</span> Equity Tower 25th Floor, SCBD lot 9<br />Jl. Jenderal Sudirman Kav.52-53<br />Jakarta 12190
                        </p>
                        <p style="margin-top:0;">
                            <!--<span style="color:#1daee5;">T.</span> 021 724 808 48-->
                        </p>

                    </address>

                </td>

                <td></td>
                <td></td>
            </tr>
        </tfoot>
    </table>


</body>
</html>