@{
    Layout = "/Views/Shared/B2BTravorama/_B2BLayout.cshtml";
    ViewBag.BodyClass = "b2b-order-list";
    ViewBag.SiteHeader = "b2b-order-list";
    ViewBag.Title = "Order List Approver";
    ViewBag.AngularController = "b2BApproverController";

}

@section AdditionalCSS{
}

@section AdditionalJS{
    <script src="/Assets/js/angular.min.js"></script>
    <script src="/Assets/js/angular-route.min.js"></script>
    <script src="/Assets/js/angular-animate.min.js"></script>

    <script src="/Assets/js/moment.min.js"></script>
    <script src="/Assets/js/moment-with-locales.min.js"></script>
    <script src="/Assets/js/xml2json.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-resource.js"></script>
    <script src="/Assets/B2BTravorama/assets/js/form_elements.js" type="text/javascript"></script>
    @*<script src="/Assets/B2BTravorama/assets/js/tables.js" type="text/javascript"></script>*@
    <script src="/Assets/B2BTravorama/assets/plugins/jquery-datatable/media/js/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="/Assets/B2BTravorama/assets/plugins/jquery-datatable/extensions/TableTools/js/dataTables.tableTools.min.js" type="text/javascript"></script>
    <script src="/Assets/B2BTravorama/assets/plugins/jquery-datatable/media/js/dataTables.bootstrap.js" type="text/javascript"></script>
    <script src="/Assets/B2BTravorama/assets/plugins/jquery-datatable/extensions/Bootstrap/jquery-datatable-bootstrap.js" type="text/javascript"></script>
    <script type="text/javascript" src="/Assets/B2BTravorama/assets/plugins/datatables-responsive/js/datatables.responsive.js"></script>
    <script type="text/javascript" src="/Assets/B2BTravorama/assets/plugins/datatables-responsive/js/lodash.min.js"></script>
}

@section PageJS{
    <script src="/Assets/travorama20/js/B2BTravorama20.js"></script>
    <script src="/Assets/travorama20/js/B2BAccountController.js"></script>
    <script src="/Assets/B2BTravorama/assets/js/tables.js" type="text/javascript"></script>
    <script>
        //jQuery(document).ready(function ($) {
        //    $('body .ol-item-hide').hide();
        //    $('body .ol-item').click(function () {
        //        $(this).parent().find('.ol-item-hide').toggle();
        //        $(this).parent().find('.ol-item').toggleClass('show');
        //        $(this).parent().siblings().find('.ol-item-hide').hide();
        //        $(this).parent().siblings().find('.ol-item').removeClass('show');
        //    });
        //});
    </script>
}

<div ng-app="travoramaB2B" ng-controller="b2BApproverController">
    <div class="order-list">
        <div class="panel panel-transparent">
            <div class="panel-heading">
                <div class="panel-title">
                    Order List Approver
                </div>
            </div>
            <div class="panel-body bg-white">
                <div class="ol-list clearfix m-b-30" ng-repeat="reservation in orderList track by $index">
                    <div class="ol-border ol-header fs-12 bold font-montserrat  padding-15 clearfix">
                        <div class="olh-name col-sm-3 no-padding">{{reservation.bookerName}}</div>
                        <div class="olh-title col-sm-9 no-padding">{{reservation.bookerMessageTitle}} <span class="label label-primary m-l-10 fs-11 text-capitalize" ng-click="infoOrder($index)" style="cursor: pointer;"><i class="fa fa-info-circle m-r-5"></i>Info</span></div>
                    </div>
                    <div class="ol-body">
                        <div class="ol-flight clearfix" ng-repeat="flight in reservation.reservationList.flights track by $index">
                            <div class="ol-item ol-border bg-white clearfix">
                                <div class="col-sm-8 no-padding clearfix flight-icon">
                                    <div class="col-sm-8 no-padding">
                                        <div class="clearfix">
                                            <div class="col-sm-5 no-padding p-l-60 m-t-20 m-b-20">
                                                <div class="bold font-montserrat fs-12">{{flight.itin.trips[0].origin}}</div>
                                                <div class="">{{flight.itin.trips[0].segments[0].departureTime | date : 'EEEE, dd MMMM yyyy'}}</div>
                                                <div class="">{{flight.itin.trips[0].segments[0].departureTime | date : 'HH:mm' :'UTC'}}</div>
                                            </div>
                                            <div class="col-sm-2 no-padding p-l-20 p-r-20 m-t-50 m-b-20"><span class="dash"></span></div>
                                            <div class="col-sm-5 no-padding p-l-60 m-t-20 m-b-20">
                                                <div class="bold font-montserrat fs-12">{{flight.itin.trips[0].destination}}</div>
                                                <div class="">{{flight.itin.trips[0].segments[0].departureTime | date : 'EEEE, dd MMMM yyyy'}}</div>
                                                <div class="">{{flight.itin.trips[0].segments[0].departureTime | date : 'HH:mm' :'UTC'}}</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-4 no-padding clearfix">
                                        <div class="col-sm-5 no-padding text-center m-t-20">
                                            <div class=" m-t-20">{{totalFlightpax(flight.pax)}} Orang</div>
                                        </div>
                                        <div class="col-sm-7 no-padding text-center m-t-20">
                                            <div class=" m-t-20">Rp. {{flight.payment.originalPrice}}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4 no-padding m-t-15 m-b-20">
                                    <div class="text-center">
                                        <button ng-if="flight.rsvStatus == 13" ng-click="updateReservation.update(flight.rsvNo, 'approved')" class="btn btn-success btn-cons m-t-15">Approve</button>
                                        <button ng-if="flight.rsvStatus == 13" ng-click="rejectReservation(flight.rsvNo, 'rejected')" class="btn btn-danger btn-cons m-t-15">Reject</button>
                                    </div>
                                </div>
                            </div>
                            <div class="ol-item-hide ol-border clearfix">
                                <div class="plane-type col-sm-2 no-padding">
                                    <div class="panel-heading bold font-montserrat fs-12">Rincian Penerbangan</div>
                                    <div class="panel-body">
                                        <div class="airline-lion">
                                            <span class=" m-r-5">
                                                <img src="flight.itin.trips[0].segments[0].airlineLogoUrl" alt="flight.itin.trips[0].segments[0].airlineName" class="flight-airline-image" width="50" height="50">
                                            </span>
                                            <span class="bold font-montserrat fs-12 text-uppercase">{{flight.itin.trips[0].segments[0].airlineName}}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="plane-pax col-sm-10 no-padding">
                                    <div class="panel-heading bold font-montserrat fs-12">Rincian Penumpang</div>
                                    <div class="panel-body">
                                        <ol class="pax-list p-l-15">
                                            <li ng-repeat="pax in flight.pax track by $index">
                                                <div class="pl-row clearfix">
                                                    <div class="col-sm-4 no-padding">Mr. {{titlePax(pax.title)}} {{pax.name}}</div>
                                                    <div class="col-sm-1 no-padding p-r-40"><span class="dash m-t-10"></span></div>
                                                    <div class="col-sm-6 no-padding">{{paxType(pax.type)}}</div>
                                                </div>
                                            </li>
                                            @*<li>
                                                    <div class="pl-row clearfix">
                                                        <div class="col-sm-4 no-padding">Mrs. Anonymous</div>
                                                        <div class="col-sm-1 no-padding p-r-40"><span class="dash m-t-10"></span></div>
                                                        <div class="col-sm-6 no-padding">Dewasa</div>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="pl-row clearfix">
                                                        <div class="col-sm-4 no-padding">Ms. Anonymous</div>
                                                        <div class="col-sm-1 no-padding p-r-40"><span class="dash m-t-10"></span></div>
                                                        <div class="col-sm-6 no-padding">Anak-anak</div>
                                                    </div>
                                                </li>*@
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="ol-hotel clearfix" ng-repeat="hotel in reservation.reservationList.hotels track by $index">
                            <div class="ol-item ol-border bg-white clearfix">
                                <div class="col-sm-8 no-padding clearfix hotel-icon">
                                    <div class="col-sm-5 no-padding clearfix">
                                        <div class="p-l-60 m-t-20 m-b-20">
                                            <div class="bold font-montserrat fs-12">{{hotel.hotelDetail.hotelName}}</div>
                                            <div class="">{{hotel.hotelDetail.zone}}, {{hotel.hotelDetail.destinationName}}, {{hotel.hotelDetail.country}}</div>
                                            <div class="">{{hotel.hotelDetail.checkIn | date : 'EEEE, dd MMM yyyy'}} - {{hotel.hotelDetail.checkOut | date : 'EEEE, dd MMM yyyy'}}</div>
                                        </div>
                                    </div>
                                    <div class="col-sm-7 no-padding clearfix">
                                        <div class="col-sm-6 no-padding p-l-60 m-t-30">
                                            <ul class="p-l-20">
                                                <li>{{totalpax(hotel.hotelDetail).totalAdult}} Dewasa, {{totalpax(hotel.hotelDetail).totalChild}} Anak</li>
                                                <li>{{sumRoom(hotel.hotelDetail)}} Kamar</li>
                                            </ul>
                                        </div>
                                        <div class="col-sm-6 no-padding text-center m-t-20">
                                            <div class=" m-t-20">Rp. {{hotel.payment.originalPrice}}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4 no-padding m-t-15 m-b-20">
                                    <div class="text-center">
                                        <button class="btn btn-success btn-cons m-t-15" ng-if="hotel.rsvStatus == 13" ng-click="updateReservation.update(hotel.rsvNo, 'approved')">Approve</button>
                                        <button class="btn btn-danger btn-cons m-t-15" ng-if="hotel.rsvStatus == 13" ng-click="rejectReservation(hotel.rsvNo, 'rejected')">Reject</button>
                                    </div>
                                </div>
                            </div>
                            <div class="ol-item-hide ol-border clearfix">
                                <div class="plane-type">
                                    <div class="panel-heading bold font-montserrat fs-12">Tipe Kamar</div>
                                    <div class="panel-body">
                                        <ul class="p-l-20">
                                            <li>{{titleCase(totalRoom(hotel.hotelDetail))}}</li>
                                            <li>1x Deluxe (Kamar dan sarapan)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade stick-up in info-order" tabindex="-1" role="dialog" aria-hidden="false">
            <div class="modal-dialog p-t-100">
                <div class="modal-content-wrapper">
                    <div class="modal-content">
                        <div class="modal-header clearfix">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                <i class="pg-close fs-14"></i>
                            </button>
                            <h4 class="text-center no-margin">Detail Info</h4>
                        </div>
                        <div class="modal-body m-t-10">
                            <div class="clearfix m-b-10">
                                <div class="col-sm-3 no-padding bold">Nama</div>
                                <div class="col-sm-9 no-padding">{{bookerInfo.name}}</div>
                            </div>
                            <div class="clearfix m-b-10">
                                <div class="col-sm-3 no-padding bold">Title</div>
                                <div class="col-sm-9 no-padding">{{bookerInfo.bookerTitle}}</div>
                            </div>
                            <div class="clearfix m-b-10">
                                <div class="col-sm-3 no-padding bold">Deskripsi</div>
                                <div class="col-sm-9 no-padding">
                                    {{bookerInfo.bookerMessage}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade stick-up in req-reject" tabindex="-1" role="dialog" aria-hidden="false">
            <div class="modal-dialog modal-sm p-t-100">
                <div class="modal-content-wrapper">
                    <div class="modal-content">
                        <div class="modal-header clearfix">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                <i class="pg-close fs-14"></i>
                            </button>
                            <h4 class="text-center no-margin">Keterangan</h4>
                        </div>
                        <div class="modal-body m-t-10">
                            <textarea class="m-b-15" ng-model="updateData.message" style="border: 1px solid #f0f0f0; width: 100%; height: 100px; padding: 10px; border-radius: 2px;" placeholder="Tulis keterangan Anda"></textarea>
                            <div class="row">
                                <div class="col-sm-6">
                                    <button type="button" class="btn btn-default btn-block" data-dismiss="modal">Kembali</button>
                                </div>
                                <div class="col-sm-6">
                                    <button type="button" class="btn btn-primary btn-block" ng-click="updateReservation.update(updateData.rsvNo, updateData.status)" data-dismiss="modal">Simpan</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>