@using Lunggo.ApCommon.Hotel.Service
@model Lunggo.CustomerWeb.Models.HotelDetailModel.HotelDetail
@{
    Layout = "/Views/Shared/mobile/_Layout.cshtml";
    ViewBag.BodyClass = "page-hotel page-detail";
    ViewBag.Title = "Detail Hotel";
    ViewBag.CurrentPage = "detail-hotel";
    ViewBag.AngularController = "hotelDetailController";
}
@{

    var hotelCd = Model.HotelCode;
    var hotelDetail = HotelService.GetInstance().GetHotelDetailFromTableStorage(Convert.ToInt32(hotelCd));
    var loc = ToTitleCase(hotelDetail.HotelName + ", " + hotelDetail.City);
}

@functions{

    public string ToTitleCase(string input)
    {

        var text = "";
        try
        {
            var splittedText = input.Split(' ');
            foreach (var word in splittedText)
            {
                var splittedByStrips = word.Split('-');
                var w = "";
                if (splittedByStrips.Count() != 1)
                {
                    foreach (var part in splittedByStrips)
                    {
                        w += ApplyTitleCase(part) + "-";
                    }
                    text += w.Substring(0, w.Length - 1) + " ";
                }
                else
                {
                    text += word[0] + word.Substring(1, word.Length - 1).ToLower() + " ";
                }
            }

        }
        catch
        {

        }
        return text.Length == 0 ? "" : text.Substring(0, text.Length - 1);
    }

    public string ApplyTitleCase(string input)
    {
        return input[0] + input.Substring(1, input.Length - 1).ToLower();
    }

}
@section AdditionalCSS{
    <link href="/Assets/css/jquery-ui.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="/Assets/vendor/slick/slick.css" />
}

@section AdditionalJS {
    <script>
        var loc = '@loc';
    </script>
    <script type="text/javascript" src="/Scripts/bootstrap.min.js"></script>
    <script type="text/javascript" src="/Assets/vendor/slick/slick.min.js"></script>
    <script type="text/javascript" src="/Assets/vendor/dotdotdot/jquery.dotdotdot.min.js"></script>
}

@section PageJS{
    
<script src="/Assets/travorama20/js/hotelDetailController.js"></script>
    <script src="/Assets/mobile/js/HotelController.js"></script>
    <script src="/Assets/travorama20/angularDirectory/search/hotelSearch.service.js"></script>
}
<div class="travorama-hotel-mobile" ng-init="init(@Newtonsoft.Json.JsonConvert.SerializeObject(Model))">
    <div class="top-content">
        @Html.Partial("/Views/Hotel/Shared/Mobile/_Summary.cshtml")
        <div class="hotel-detail-menu clearfix">
            <div class="hotel-detail-menu-action">
                <a href="#" attr-link="#detail-menu">UMUM</a>
                <a href="#" attr-link="#spec-menu">RINCIAN</a>
            </div>
            </div>
        </div>
    <div class="detail-hotel-container">
        <div class="detail-tab detail-hotel" id="detail-menu">
            <div class="dh-slider">
                <div class="item active">
                    <div class="dh-img" style="background-image: url({{hotel.images[0]}});"></div>
                </div>
                <div class="item">
                    <div class="dh-img" style="background-image: url({{hotel.images[1]}});"></div>
                </div>
            </div>
            <div class="dh-title">
                <div class="dh-name lg-txt blue-txt bold-txt">{{hotel.hotelName}}</div>
                <div class="clearfix">
                    <div class="col-half" ng-if="hotel.starRating == 1"><span class="star"></span></div>
                    <div class="col-half" ng-if="hotel.starRating == 2"><span class="star star-2"></span></div>
                    <div class="col-half" ng-if="hotel.starRating == 3"><span class="star star-3"></span></div>
                    <div class="col-half" ng-if="hotel.starRating == 4"><span class="star star-4"></span></div>
                    <div class="col-half" ng-if="hotel.starRating == 5"><span class="star star-5"></span></div>
                    <div class="col-half share-group">
                        <a href="#" class="like"></a>
                        <a href="#" class="share"></a>
                    </div>
                </div>
            </div>
            <div class="dh-location sm-txt" >
                {{hotel.address}} {{hotel.city}} {{hotel.postalCd}}, {{hotel.country}}
            </div>
            <div class="dh-listing">
                <div class="dh-list-title bold-txt lg-txt darkgrey-txt">Informasi Kamar & Harga </div>
                <div ng-show="loading" class="text-center">
                    <img src="/Assets/images/load.gif" style="width: 30px; height: 30px; margin-top: 5%;">
                </div>
                <ul class="dh-list-container">
                    <li ng-show="$index+1 <= roomCount" ng-repeat="room in hotel.room track by $index">
                        <div class="dh-list clearfix">
                            <div class="col-left-hotel"><img src="{{room.roomImages[0]}}" alt="Hotel" /></div>
                            <div class="col-right-hotel">
                                <div class="bold-txt lg-txt darkgrey-txt">{{room.roomName}}</div>
                                <div class="sm-txt grey-txt">
                                    <div ng-show="room.rate.isFreeCancel">Pembatalan Gratis </div>
                                    <div ng-show="!room.rate.isFreeCancel && room.rate.isRefundable">Kebijakan Pembatalan Berlaku </div>
                                    <div ng-show="!room.rate.isFreeCancel && !room.rate.isRefundable">TIdak Dapat Dibatalkan </div>
                                    <span class="max-visitor">Max {{room.paxCapacity}} orang</span>
                                </div>
                                <div class="price orange-txt">
                                    <div class="underline-txt sm-txt">Rp {{room.rate.originalFare | number}}</div>
                                    <a href="#" class="detail"></a>
                                    <div class="lg-txt"><b><sup>Rp</sup> {{room.rate.netFare | number}}</b></div>
                                    <span class="xs-txt">(*Termasuk Pajak)</span>
                                </div>
                                <a href="#" class="blue-txt downline-txt sm-txt" ng-click="PageConfig.SetOverlay('detail-room'); seeRoomDetail(room)">Detail Info Kamar</a>
                                    <div class="facility">
                                        <span class="wifi"></span>
                                        <span class="meal"></span>
                                        <span class="ac"></span>
                                    </div>
                                    <div class="room clearfix">
                                    @*<span class="room-title darkgrey-txt semibold-txt">Kamar</span>
                                        <div class="counter-room clearfix">
                                            <span class="btn-room btn-min"></span>
                                            <input type="text" name="counter" class="result-room semibold-txt" value="0" readonly="readonly" />
                                            <span class="btn-room btn-plus" attr-limit="9"></span>
                                    </div>*@
                                        <a href="#" class="btn btn-yellow small">PESAN</a>
                                    </div>
                                </div>
                            </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="detail-tab spec-hotel" id="spec-menu">
            <div class="sh-desc" ng-show="hotel.description.length > 0">
                <div class="sh-title darkgrey-txt lg-txt bold-txt">Deskripsi </div>
                <div ng-show="loading" class="text-center">
                    <img src="/Assets/images/load.gif" style="width: 30px; height: 30px; margin-top: 5%;">
                </div>
                <div class="sh-txt darkgrey-txt">
                    <span ng-repeat="description in hotel.description track by $index">{{description}}<br /></span>
                </div>
                <a class="toggle"><span class="sh-open"></span><span class="sh-close"></span></a>
            </div>
            <div class="sh-facility">
                <div class="sh-title darkgrey-txt lg-txt bold-txt">Fasilitas Utama Hotel</div>
                <div ng-show="loading" class="text-center">
                    <img src="/Assets/images/load.gif" style="width: 30px; height: 30px; margin-top: 5%;">
                </div>
                <div class="sh-list-facility grey-txt clearfix">
                    <div class="sh-row clearfix" ng-repeat="facilities in hotel.facilities track by $index" ng-hide="facilities === undefined">
                        <div class="col-2" ng-class="{'fac-general':facilities.facilityGroup == 'general',
                                                                        'fac-health':facilities.facilityGroup == 'health',
                                                                        'fac-sport':facilities.facilityGroup == 'sport',
                                                                        'fac-business':facilities.facilityGroup == 'business',
                                                                        'fac-meal':facilities.facilityGroup == 'meal',
                                                                        'fac-ent':facilities.facilityGroup == 'entertainment',
                                                                        'fac-other':facilities.facilityGroup == 'other'}">
                         
                        </div>
                        <div class="col-8 clearfix">
                            <ul class="col-half blue-list" ng-repeat="facilityList in facilities.facilityList.slice(0, facilities.facilityList.length/2)">
                                <li ng-repeat="facilityName in facilityList"> {{facilityName}}</li>
                            </ul>
                            <ul class="col-half blue-list" ng-repeat="facilityList in facilities.facilityList.slice(facilities.facilityList.length/2, facilities.facilityList.length)">
                                <li ng-repeat="facilityName in facilityList"> {{facilityName}}</li>
                            </ul>
                        </div>
                    </div>
                    
                    @*<ul class="col-half sh-list">
                        <li class="bed-blue">Bed</li>
                        <li class="meal-blue">Breakfast</li>
                        <li class="bell-blue">Room Service</li>
                        <li class="wifi-blue">Public WiFi</li>
                        <li class="bed-blue">Bed</li>
                        <li class="meal-grey">Breakfast</li>
                        <li class="bell-grey">Room Service</li>
                        <li class="wifi-grey">Public WiFi</li>
                    </ul>
                    <ul class="col-half sh-list">
                        <li class="pool-blue">Swimming Pool</li>
                        <li class="meal-blue">Breakfast</li>
                        <li class="tv-blue">TV</li>
                        <li class="car-blue">Hotel Car</li>
                        <li class="ac-grey">AC</li>
                        <li class="tv-blue">TV</li>
                        <li class="car-blue">Hotel Car</li>
                        <li class="ac-blue">AC</li>
                    </ul>*@
                </div>
            </div>
            <div class="sh-policy" ng-show="hotel.policy.length > 0">
                <div class="sh-title darkgrey-txt lg-txt bold-txt">Perlu Diingat</div>
                <div ng-show="loading" class="text-center">
                    <img src="/Assets/images/load.gif" style="width: 30px; height: 30px; margin-top: 5%;">
            </div>
                <div class="sh-policy-txt darkgrey-txt">
                    <ul>
                        <li ng-repeat="policy in hotel.policy track by $index">{{policy}}</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="overlay overlay--theme--blue overlay--detail-room" ng-class="{ 'active' : (PageConfig.ActiveOverlay == 'detail-room') }">
        <header class="overlay__header">
            <h3 class="overlay__title">
                INFO KAMAR
                <span class="overlay__close" ng-click="PageConfig.SetOverlay()">X</span>
            </h3>
        </header>
        <section class="overlay__content">
            <div class="overlay-selector">
                <div class="overlay-selector__body">
                    <div class="dr-container">
                        <div class="dr-title">
                            <div class="dr-name lg-txt blue-txt bold-txt">{{hotel.hotelName}}</div>
                            <div class="clearfix">
                                <div class="col-half" ng-if="hotel.starRating == 1"><span class="star"></span></div>
                                <div class="col-half" ng-if="hotel.starRating == 2"><span class="star star-2"></span></div>
                                <div class="col-half" ng-if="hotel.starRating == 3"><span class="star star-3"></span></div>
                                <div class="col-half" ng-if="hotel.starRating == 4"><span class="star star-4"></span></div>
                                <div class="col-half" ng-if="hotel.starRating == 5"><span class="star star-5"></span></div>
                                <div class="col-half share-group">
                                    <a href="#" class="like"></a>
                                    <a href="#" class="share"></a>
                                </div>
                            </div>
                        </div>
                        <div class="dr-slider dh-slider">
                            <div class="item active">
                                <img src="{{selectedRoom.roomImages[0]}}" />
                            </div>
                            <div class="item">
                                <img src="{{selectedRoom.roomImages[1]}}" />
                            </div>
                        </div>
                        <div class="dr-detail">
                            <div class="bold-txt lg-txt darkgrey-txt">{{selectedRoom.roomName}} ({{selectedRoom.rate.boardDesc}})</div>
                            <div class="sm-txt grey-txt">
                                <div ng-show="selectedRoom.rate.isFreeCancel">Pembatalan Gratis </div>
                                <div ng-show="!selectedRoom.rate.isFreeCancel && selectedRoom.rate.isRefundable">Kebijakan Pembatalan Berlaku </div>
                                <div ng-show="!selectedRoom.rate.isFreeCancel && !selectedRoom.rate.isRefundable">TIdak Dapat Dibatalkan </div>
                                <span class="max-visitor">Max {{selectedRoom.paxCapacity}} orang</span>
                            </div>
                            <div class="price orange-txt">
                                <div class="underline-txt sm-txt">Rp {{selectedRoom.rate.originalFare}}</div>
                                <a href="#" class="detail"></a>
                                <div class="lg-txt"><b><sup>Rp</sup> {{selectedRoom.rate.netFare}}</b></div>
                                <span class="xs-txt">(*Termasuk Pajak)</span>
                            </div>
                            <a ng-click="bookRoom(room)" class="btn btn-yellow small">PESAN</a>
                        </div>
                        <div class="dr-policy">
                            <div class="bold-txt lg-txt darkgrey-txt">Kebijakan Pembatalan</div>
                            <div class="dr-txt darkgrey-txt">
                                <div ng-show="room.rate.isFreeCancel">
                                    -
                                    Gratis pembatalan sebelum <span style="color:#1daee4">{{selectedRoom.rate.freeUntil | date:'dd MMM yyyy HH:mm'}}</span> WIB.
                                </div>
                                <div ng-repeat="cancellation in selectedRoom.rate.cancellation track by $index">
                                    @*Gratis pembatalan sebelum 17-Nov-2016 17:00.*@
                                    - Pembatalan setelah <span style="color:#1daee4">{{cancellation.startTime | date:'dd MMM yyyy '}}</span>
                                    akan dikenakan biaya pembatalan sebesar <span style="color:#ff7200">Rp {{cancellation.singleFee | number}}</span>.
                                    <br />
                                </div>
                            </div>
                        </div>
                        <div class="dr-info">
                            <div class="bold-txt lg-txt darkgrey-txt">Info Kamar</div>
                            <ul class="dr-txt darkgrey-txt">
                                <div ng-repeat="tnc in selectedRoom.rate.tnc">{{tnc}} <br /></div>
                                @*<li class="check-in col-3 sm-txt"><span class="grey-txt">Check In</span> 14.00-24.00</li>
                                <li class="check-out col-3 sm-txt"><span class="grey-txt">Check Out</span> 12.00</li>
                                <li class="max-visitor col-3 sm-txt"><span class="grey-txt">Max Orang</span> 2 Orang</li>*@
                                </ul>
                            </div>
                        
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>