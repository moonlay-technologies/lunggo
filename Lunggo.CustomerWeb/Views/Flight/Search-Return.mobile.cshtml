@using System.Globalization

@using Lunggo.ApCommon.Flight.Constant
@using Lunggo.ApCommon.Flight.Model
@using Lunggo.ApCommon.Flight.Service
@using Lunggo.CustomerWeb.Models
@using Newtonsoft.Json
@model FlightSearchData

@{
    bool isValid;

    List<FlightTrip> trips = null;
    List<FlightTrip> departTrip = null;
    List<FlightTrip> returnTrip = null;
    FlightSearchData.Complete data = null;
    var originAirportNames = new List<string>();
    var destinationAirportNames = new List<string>();
    var originCityNames = new List<string>();
    var destinationCityNames = new List<string>();
    var originCountryNames = new List<string>();
    var destinationCountryNames = new List<string>();

    String tripType = "aaa";
    try
    {
        var parts = Model.info.Split('-');
        var tripPart = parts.First();
        var infoPart = parts.Last();
        isValid = ((tripPart.Length + 1) % 13 == 0) && (infoPart.Length == 4);

        trips = tripPart.Split('.').Select(info => new FlightTrip
        {
            OriginAirport = info.Substring(0, 3),
            OriginCity = FlightService.GetInstance().GetAirportCity(info.Substring(0, 3)),
            DestinationAirport = info.Substring(3, 3),
            DestinationCity = FlightService.GetInstance().GetAirportCity(info.Substring(3, 3)),
            DepartureDate = new DateTime(
                2000 + int.Parse(info.Substring(10, 2)),
                int.Parse(info.Substring(8, 2)),
                int.Parse(info.Substring(6, 2)))
        }).ToList();

        foreach (var trip in trips)
        {
            originAirportNames.Add(FlightService.GetInstance().GetAirportName(trip.OriginAirport));
            destinationAirportNames.Add(FlightService.GetInstance().GetAirportName(trip.DestinationAirport));
            originCityNames.Add(FlightService.GetInstance().GetAirportCity(trip.OriginAirport));
            destinationCityNames.Add(FlightService.GetInstance().GetAirportCity(trip.DestinationAirport));
            originCountryNames.Add(FlightService.GetInstance().GetAirportCountry(trip.OriginAirport));
            destinationCountryNames.Add(FlightService.GetInstance().GetAirportCountry(trip.DestinationAirport));
        }

        data = new FlightSearchData.Complete
        {
            AdultCount = int.Parse(infoPart.Substring(0, 1)),
            ChildCount = int.Parse(infoPart.Substring(1, 1)),
            InfantCount = int.Parse(infoPart.Substring(2, 1)),
            CabinClass = FlightService.GetInstance().ParseCabinClass(infoPart.Substring(3, 1)),
            Trips = trips,
            TripType = FlightService.GetInstance().ParseTripType(trips)
        };

        tripType = data.TripType == TripType.OneWay ? "single" : "return";

        departTrip = new List<FlightTrip> { trips[0] };
        returnTrip = new List<FlightTrip> { trips[1] };
    }
    catch
    {
        isValid = false;
    }

}


@{
    Layout = "/Views/Shared/mobile/_Layout.cshtml";
    ViewBag.Title = "Pencarian Penerbangan Pergi Pulang";
    ViewBag.BodyClass = "page page-flight single-flight";
    ViewBag.AngularController = "ReturnFlightController";
    ViewBag.FlightSwap = "true";
}

@section AdditionalJS {
    <script src="/Assets/js/angular.min.js"></script>
    <script src="/Assets/js/angular-animate.min.js"></script>
    <script src="/Assets/js/angular-route.min.js"></script>
}
@section AdditionalCSS{
    <link href="/Assets/css/jquery-ui.min.css" rel="stylesheet" />
}
@section PageJS{

    <script>
    FlightSearchConfig.flightForm = {
        cabin: '@data.CabinClass',
        departureDate: '@trips[0].DepartureDate',
        origin: '@trips[0].OriginAirport',
        destination: '@trips[0].DestinationAirport',
        passenger: {
            adult: @data.AdultCount,
            child: @data.ChildCount,
            infant: @data.InfantCount,
        },
        type: 'OneWay',
        trips: [@Html.Raw(JsonConvert.SerializeObject(departTrip)),@Html.Raw(JsonConvert.SerializeObject(returnTrip)) ],
            Requests:[],
            SecureCode: '@ViewBag.RequestId'
    };
    </script>
@*<script type="text/javascript" src="/Assets/js/jquery.ui.datepicker-id.js"></script>*@
    <script src="/Assets/mobile/js/returnFlightController.js"></script>
}


<div class="page-loading" ng-class="{'page-loaded':PageConfig.Loaded}">
    
    
        <form class="hidden push-token pushToken" id="pushToken" action="/id/Flight/Select" method="post">
            <input type="text" name="Token" id="fareToken" class="fareToken" value="" />
        </form>

        <div class="flight-loading" ng-hide="( (FlightConfig[0].FlightRequest.Progress + FlightConfig[1].FlightRequest.Progress) / 2 ) == 100">
            <div class="flight-progress" style="width:{{(FlightConfig[0].FlightRequest.Progress + FlightConfig[1].FlightRequest.Progress) / 2}}%;"></div>
        </div><!-- .flight-loading -->

        <section class="flight-summary">
            <div class="summary-left">
                <p ng-show="PageConfig.ActiveSection == 'departure'">
                    <b>Penerbangan Pergi</b><br />
                    <b>{{FlightConfig[0].FlightRequest.Trips[0].OriginCity}}</b> ke <b>{{FlightConfig[0].FlightRequest.Trips[0].DestinationCity}}</b> - {{FlightConfig[0].FlightRequest.Trips[0].DepartureDate | date:'EEE, dd MMM yyyy'}}
                </p>
                <p ng-show="PageConfig.ActiveSection == 'return'">
                    <b>Penerbangan Pulang</b><br />
                    <b>{{FlightConfig[1].FlightRequest.Trips[0].OriginCity}}</b> ke <b>{{FlightConfig[1].FlightRequest.Trips[0].DestinationCity}}</b> - {{FlightConfig[1].FlightRequest.Trips[0].DepartureDate | date:'EEE, dd MMM yyyy'}}
                </p>
            </div>
            <a ng-click="SetOverlay('flight-form')" class="summary-right"><span>GANTI</span></a>
        </section><!-- .flight-summary -->


    <section class="flight-sort-filter flight-sort-filter--departure" ng-show="PageConfig.ActiveSection == 'departure' && FlightConfig[0].FlightRequest.Progress == 100">
        <div class="flight-sort-filter-action">
            <a ng-click="SetOverlay('flight-filter-departure')">FILTER</a>
            <a ng-click="SetOverlay('flight-sort-departure')">SORTIR</a>
        </div>
    </section><!-- .flight-sort -->

    <section class="flight-sort-filter flight-sort-filter--return" ng-show="PageConfig.ActiveSection == 'return' &&  FlightConfig[1].FlightRequest.Progress == 100">
        <div class="flight-sort-filter-action">
            <a ng-click="SetOverlay('flight-filter-return')">FILTER</a>
            <a ng-click="SetOverlay('flight-sort-return')">SORTIR</a>
        </div>
    </section><!-- .flight-sort -->
        <section class="flight-notice" ng-show="FlightConfig[0].FlightList.length > 0">
            <p>Tampilan harga untuk <b>{{ FlightConfig[0].FlightRequest.AdultCount + FlightConfig[0].FlightRequest.ChildCount + FlightConfig[0].FlightRequest.InfantCount | number }} orang</b> ({{FlightConfig[0].FlightRequest.AdultCount}} Dewasa<span ng-if="FlightConfig[0].FlightRequest.ChildCount > 0">, {{FlightConfig[0].FlightRequest.ChildCount}} Anak</span><span ng-if="FlightConfig[0].FlightRequest.InfantCount">, {{FlightConfig[0].FlightRequest.InfantCount}} Bayi</span>)</p>
        </section><!-- .flight-notice -->

        <section class="container_new flight-list" ng-show="FlightConfig[0].FlightList.length == 0 && !(!departureFlight.length && FlightConfig[0].FlightRequest.Progress == 100)">
            <img class="loading-image" src="/Assets/images/load.gif" alt="Loading" />
        </section>

        <section class="flight-list" id="departure-flight" ng-show="PageConfig.ActiveSection == 'departure'">

            <div class="flight-selection" ng-show="FlightConfig[1].ActiveFlight >= 0">
                <div class="flight-info flight-info--return">
                    <span>Pulang : <br /> {{FlightConfig[1].FlightList[FlightConfig[1].ActiveFlight].trips[0].airlines[0].name}} (Rp {{FlightConfig[1].FlightList[FlightConfig[1].ActiveFlight].totalFare | number}})</span>
                </div>
                <a ng-click="FlightFunction.SetActiveFlight('return',-1); SetSection('return');" class="change-departure"><span>Ganti</span></a>
            </div><!-- .flight-selection -->
            @*filter: priceFilter('departure') |*@
    @*|  filter:FlightFiltering.AirlineFilter('departure') | filter:FlightFiltering.TransitFilter('departure') | filter: priceFilter('departure') | filter:FlightFiltering.DepartureTimeFilter('departure') | filter:FlightFiltering.ArrivalTimeFilter('departure') | orderBy:FlightConfig[0].FlightSort.Value:FlightConfig[0].FlightSort.Invert)"
    id="flight-{{Flight.IndexNo}}" ng-click="FlightFunctions.ShowDetail('departure',Flight.IndexNo*@
            <div class="flight" ng-repeat="Flight in departureFlight = (FlightConfig[0].FlightList);"
                 id="flight-{{Flight.IndexNo}}" ng-click="FlightFunctions.ShowDetail('departure',Flight.IndexNo)">
                <div class=" flight-header">
                    <h4 class="flight-airline">
                        <img ng-src="{{Flight.trips[0].airlines[0].logoUrl}}" alt="{{Flight.trips[0].airlines[0].name}}" class="flight-airline-image" />
                        <span>{{Flight.trips[0].airlines[0].name}}</span>
                    </h4>
                </div>
                <div class="flight-content">
                    <div class="content-left">
                        <h4 class="flight-time">
                            <span class="departure">{{Flight.trips[0].segments[0].departureTime | date: 'HH:mm' :'UTC'}}</span>
                            <span class="separator"></span>
                            <span class="arrival">{{Flight.trips[0].segments[ Flight.trips[0].segments.length - 1 ].arrivalTime | date: 'HH:mm' : 'UTC'}}</span>
                            <span class="overday" ng-show="(getOverdayDate(Flight.trips[0].segments[0].departureTime,
                                  Flight.trips[0].segments[ Flight.trips[0].segments.length - 1 ].arrivalTime) != 0)">
                                {{getOverdayDate(Flight.trips[0].segments[0].departureTime,Flight.trips[0].segments[ Flight.trips[0].segments.length - 1 ].arrivalTime)}}
                            </span>
                        </h4>
                        <h5 class="flight-duration">
                            {{msToTime( Flight.trips[0].totalDuration )}},
                            <span ng-show="Flight.trips[0].transitCount == 0">Langsung</span>
                            <span ng-show="Flight.trips[0].transitCount > 0">{{Flight.trips[0].transitCount}} Transit</span>
                        </h5>
                    </div>
                    <div class="content-right">
                        <label>Harga Total :</label>
                        <h5 class="flight-price-was" ng-show="Flight.originalFare">Rp {{Flight.originalFare | number}}</h5>
                        <h4 class="flight-price">Rp {{Flight.totalFare | number}}</h4>
                    </div>
                </div>
                <div class="flight-footer">
                    <a class="flight-detail-button">Lihat Detail &gt;</a>
                    <a ng-click="$event.stopPropagation(); FlightFunctions.SetActiveFlight('departure',Flight.IndexNo); $event.stopPropagation();" class="btn btn-yellow pull-right flight-order">PESAN</a>
                </div>
            </div>

        </section><!-- .flight-list#departure-flight -->

        <section class="flight-list" id="return-flight" ng-show="PageConfig.ActiveSection == 'return'">

            <div class="flight-selection" ng-show="FlightConfig[0].ActiveFlight >= 0">
                <div class="flight-info">
                    <span>Pergi : <br /> {{FlightConfig[0].FlightList[FlightConfig[0].ActiveFlight].trips[0].airlines[0].name}} (Rp {{FlightConfig[0].FlightList[FlightConfig[0].ActiveFlight].totalFare | number}})</span>
                </div>
                <a ng-click="FlightFunction.SetActiveFlight('departure',-1); SetSection('departure');" class="change-departure"><span>Ganti</span></a>
            </div><!-- .flight-selection -->
            @* filter: priceFilter('return') |*@
    @*| filter:FlightFiltering.AirlineFilter('return') | filter:FlightFiltering.TransitFilter('return') | filter: priceFilter('return') | filter:FlightFiltering.DepartureTimeFilter('return') | filter:FlightFiltering.ArrivalTimeFilter('return') | orderBy:FlightConfig[1].FlightSort.Value:FlightConfig[1].FlightSort.Invert*@
            <div class="flight" ng-repeat="Flight in returnFlight = (FlightConfig[1].FlightList )"
                 id="flight-{{Flight.IndexNo}}" ng-click="FlightFunctions.ShowDetail('return',Flight.IndexNo);">
                <div class="flight-header">
                    <h4 class="flight-airline">
                        <img ng-src="{{Flight.trips[0].airlines[0].logoUrl}}" alt=" {{Flight.trips[0].airlines[0].name}} " class=" flight-airline-image" />
                        <span>{{Flight.trips[0].airlines[0].name}}</span>
                    </h4>
                </div>
                <div class="flight-content">
                    <div class="content-left">
                        <h4 class="flight-time">
                            <span class="departure">{{Flight.trips[0].segments[0].departureTime | date: 'HH:mm' :'UTC'}}</span>
                            <span class="separator"></span>
                            <span class="arrival">{{Flight.trips[0].segments[ Flight.trips[0].segments.length - 1 ].arrivalTime | date: 'HH:mm' : 'UTC'}}</span>
                            <span class="overday" ng-show="(getOverdayDate(Flight.trips[0].segments[0].departureTime,
                                  Flight.trips[0].segments[ Flight.trips[0].segments.length - 1 ].arrivalTime) != 0)">
                                {{getOverdayDate(Flight.trips[0].segments[0].departureTime,Flight.trips[0].segments[ Flight.trips[0].segments.length - 1 ].arrivalTime)}}
                            </span>
                        </h4>
                        <h5 class="flight-duration">
                            {{msToTime( Flight.trips[0].totalDuration )}},
                            <span ng-show="Flight.trips[0].transitCount == 0">Langsung</span>
                            <span ng-show="Flight.trips[0].transitCount > 0">{{Flight.trips[0].transitCount}} Transit</span>
                        </h5>
                    </div>
                    <div class="content-right">
                        <label>Harga Total :</label>
                        <h5 class="flight-price-was" ng-show="Flight.originalFare">Rp {{Flight.originalFare | number}}</h5>
                        <h4 class="flight-price">Rp {{Flight.totalFare | number}}</h4>
                    </div>
                </div>
                <div class="flight-footer">
                    <a class="flight-detail-button">Lihat Detail &gt;</a>
                    <a ng-click="$event.stopPropagation(); FlightFunctions.SetActiveFlight('return',Flight.IndexNo); $event.stopPropagation();" class="btn btn-yellow pull-right flight-order">PESAN</a>
                </div>
            </div>

        </section><!-- .flight-list#return-flight -->
    
        <!-- overlay - flight detail -->
        <div class="overlay overlay--theme--blue overlay--flight-detail" ng-class="{'active' : (PageConfig.ActiveOverlay == 'flight-detail')}">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    DETAIL PENERBANGAN
                    <span class="overlay__close" ng-click="FlightFunctions.SetActiveFlight(); SetOverlay()" ng-hide="PageConfig.Validating">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <div ng-if="PageConfig.ActiveSection == 'departure'">
                    <div class="flight-title flight-title--departure">
                        <div class="flight-info">
                            <h4><b>{{FlightConfig[0].FlightRequest.Trips[0].OriginCity}}</b> to <b>{{FlightConfig[0].FlightRequest.Trips[0].DestinationCity}}</b></h4>
                            <h5>{{FlightConfig[0].FlightRequest.Trips[0].DepartureDate | date: 'EEE, dd MMM yyyy'}}</h5>
                        </div>
                        <a href="#" class="flight-change" ng-hide="PageConfig.Validating"><span ng-click="FlightFunctions.SetActiveFlight('departure',-1); SetOverlay();">GANTI</span></a>
                    </div>
                    
                    <div class="flight-wrapper" ng-repeat="Segment in FlightConfig[0].FlightList[ FlightConfig[0].DetailFlight ].trips[0].segments track by $index">
                        <div class="transit" ng-if="$index > 0">
                            <span>Transit di {{Segment.departureCity}} ({{Segment.departure}}) selama  <b>{{msToTime(FlightConfig[0].FlightList[FlightConfig[0].DetailFlight].trips[0].transits[$index-1].duration) | date : 'HH:mm'}}</b></span>
                        </div>
                        <div class="flight">
                            <div class="flight__number">
                                <span>{{$index + 1}}</span>
                            </div>
                            <div class="flight__content">
                                <div class="flight__summary">
                                    <img ng-src="{{Segment.airlineLogoUrl}}" alt="{{Segment.airlineName}}" class="flight__image" />
                                    <div class="flight__airline">
                                        <h4><b>{{Segment.airlineName}}</b></h4>
                                        <h5>{{Segment.airlineCd}}-{{Segment.flightNo}}</h5>
                                    </div>
                                </div>
                                <div class="flight__detail">
                                    <div class="flight__departure">
                                        <h5>{{Segment.departureTime | date: 'dd MMM yyyy' : 'UTC'}}</h5>
                                        <h4><b>{{Segment.departureTime | date : 'HH:mm' : 'UTC'}}</b></h4>
                                        <h5><b>{{Segment.departureCity}} ({{Segment.departure}})</b></h5>
                                        <h5>{{Segment.departuretName}}</h5>
                                    </div>
                                    <div class="flight__separator">
                                        <h5><b>Durasi: </b> {{(Segment.duration)}}</h5>
                                    </div>
                                    <div class="flight__arrival">
                                        <h5>{{Segment.arrivalTime | date: 'dd MMM yyyy' : 'UTC'}}</h5>
                                        <h4><b>{{Segment.arrivalTime | date : 'HH:mm' : 'UTC'}}</b></h4>
                                        <h5><b>{{Segment.arrivalCity}} ({{Segment.arrival}}) </b></h5>
                                        <h5>{{Segment.arrivalName}}</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div ng-if="PageConfig.ActiveSection == 'return'">
                    <div class="flight-title flight-title--return">
                        <div class="flight-info">
                            <h4><b>{{FlightConfig[1].FlightRequest.Trips[0].OriginCity}}</b> to <b>{{FlightConfig[1].FlightRequest.Trips[0].DestinationCity}}</b></h4>
                            <h5>{{FlightConfig[1].FlightRequest.Trips[0].DepartureDate | date: 'EEE, dd MMM yyyy'}}</h5>
                        </div>
                        <a href="#" class="flight-change" ng-hide="PageConfig.Validating"><span ng-click="FlightFunctions.SetActiveFlight('return',-1); SetOverlay();">GANTI</span></a>
                    </div>

                    <div class="flight-wrapper" ng-repeat="Segment in FlightConfig[1].FlightList[ FlightConfig[1].DetailFlight ].Trips[0].Segments track by $index">
                        <div class="transit" ng-if="$index > 0">
                            <span>Transit di {{Segment.departureCity}} ({{Segment.departure}}) selama <b>{{{msToTime(FlightConfig[1].FlightList[FlightConfig[0].DetailFlight].trips[0].transits[$index-1].duration) | date : 'HH:mm'}}</b></span>
                        </div>
                        <div class="flight">
                            <div class="flight__number">
                                <span>{{$index + 1}}</span>
                            </div>
                            <div class="flight__content">
                                <div class="flight__summary">
                                    <img ng-src="{{Segment.airlineLogoUrl}}" alt="{{Segment.airlineName}}" class="flight__image" />
                                    <div class="flight__airline">
                                        <h4><b>{{Segment.airlineName}}</b></h4>
                                        <h5>{{Segment.airlineCd}}-{{Segment.flightNo}}</h5>
                                    </div>
                                </div>
                                <div class="flight__detail">
                                    <div class="flight__departure">
                                        <h5>{{Segment.departureTime | date: 'dd MMM yyyy' : 'UTC'}}</h5>
                                        <h4><b>{{Segment.departureTime | date : 'HH:mm' : 'UTC'}}</b></h4>
                                        <h5><b>{{Segment.departureCity}} ({{Segment.departure}})</b></h5>
                                        <h5>{{Segment.departureName}}</h5>
                                    </div>
                                    <div class="flight__separator">
                                        <h5><b>Durasi: </b> {{(Segment.duration)}}</h5>
                                    </div>
                                    <div class="flight__arrival">
                                        <h5>{{Segment.arrivalTime | date: 'dd MMM yyyy' : 'UTC'}}</h5>
                                        <h4><b>{{Segment.arrivalTime | date : 'HH:mm' : 'UTC'}}</b></h4>
                                        <h5><b>{{Segment.arrivalCity}} ({{Segment.arrival}})</b></h5>
                                        <h5>{{Segment.arrivalName}}</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </section><!-- .overlay__content -->
            <footer class="overlay__footer">
                <div class="container_new" ng-show="PageConfig.ActiveSection == 'departure'">
                    <div class="row1">
                        <div class="col-xs-6">
                            <h5>Harga Total:</h5>
                            <h4><b>Rp {{FlightConfig[0].FlightList[ FlightConfig[0].DetailFlight ].totalFare | number}}</b></h4>
                            <h6>*Harga Sudah Termasuk Pajak dan Service Charges</h6>
                        </div>
                        <div class="col-xs-6">
                            <a ng-click="SetOverlay();FlightFunctions.SetActiveFlight('departure',FlightConfig[0].DetailFlight); SetSection('departure'); " class="btn btn-yellow btn-block">PESAN</a>
                        </div>
                    </div>
                </div>
                <div class="container_new" ng-show="PageConfig.ActiveSection == 'return'">
                    <div class="row1">
                        <div class="col-xs-6">
                            <h5>Harga Total:</h5>
                            <h4><b>Rp {{FlightConfig[1].FlightList[ FlightConfig[1].DetailFlight ].totalFare | number}}</b></h4>
                            <h6>*Harga Sudah Termasuk Pajak dan Service Charges</h6>
                        </div>
                        <div class="col-xs-6">
                            <a ng-click=" SetOverlay();FlightFunctions.SetActiveFlight('return',FlightConfig[1].DetailFlight); SetSection('return');" class="btn btn-yellow btn-block">PESAN</a>
                        </div>
                    </div>
                </div>
            </footer><!-- .overlay__footer -->
        </div>

        <!-- overlay - flight summary -->
        <div class="overlay overlay--theme--blue overlay--flight-detail" ng-class="{'active' : (PageConfig.ActiveOverlay == 'summary')}">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    DETAIL PENERBANGAN
                    <span class="overlay__close" ng-click="FlightFunctions.SetActiveFlight(); SetOverlay();" ng-hide="PageConfig.Validating">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <div>
                    <div class="flight-title flight-title--departure">
                        <div class="flight-info">
                            <h4><b>{{FlightConfig[0].FlightRequest.Trips[0].OriginAirport}}</b> ke <b>{{FlightConfig[0].FlightRequest.trips[0].destination}}</b></h4>
                            <h5>{{FlightConfig[0].FlightRequest.Trips[0].DepartureDate | date: 'EEE, dd MMM yyyy'}}</h5>
                        </div><!-- .flight-info -->
                        <a href="#" class="flight-change" ng-hide="PageConfig.Validating"><span ng-click="FlightFunctions.SetActiveFlight('departure',-1); FlightFunctions.ResetValidation(); SetSection('departure'); SetOverlay();">GANTI</span></a>
                    </div><!-- .flight-title -->

                    <div class="flight-notice" ng-show="FlightConfig[0].FlightValidated && !FlightConfig[0].FlightAvailable">
                        <div class="fare-changed" ng-show="FlightConfig[0].FlightNewPrice">Harga berubah menjadi <b>Rp {{FlightConfig[0].FlightList[ FlightConfig[0].ActiveFlight ].totalFare | number}}</b></div>
                        <div class="fare-unavailable" ng-hide="FlightConfig[0].FlightNewPrice">Penerbangan tidak tersedia.</div>
                    </div><!-- .flight-notice -->
                    
                    <div class="flight-wrapper" ng-repeat="Segment in FlightConfig[0].FlightList[ FlightConfig[0].ActiveFlight ].trips[0].segments track by $index">
                        <div class="transit" ng-if="$index > 0">
                            <span>Transit di {{Segment.departureCity}} ({{Segment.departure}}) selama <b>{{msToTime(FlightConfig[0].FlightList[FlightConfig[0].DetailFlight].trips[0].transits[$index-1].duration) | date : 'HH:mm'}}</b></span>
                        </div><!-- .transit -->
                        <div class="flight">
                            <div class="flight__number">
                                <span>{{$index + 1}}</span>
                            </div><!-- .flight__number -->
                            <div class="flight__content">
                                <div class="flight__summary">
                                    <img ng-src="{{Segment.airlineLogoUrl}}" alt="{{Segment.airlineName}}" class="flight__image" />
                                    <div class="flight__airline">
                                        <h4><b>{{Segment.airlineName}}</b></h4>
                                        <h5>{{Segment.airlineCd}}-{{Segment.flightNo}}</h5>
                                    </div>
                                </div><!-- .flight__summary -->
                                <div class="flight__detail">
                                    <div class="flight__departure">
                                        <h5>{{Segment.departureTime | date: 'dd MMM yyyy' : 'UTC'}}</h5>
                                        <h4><b>{{Segment.departureTime | date : 'HH:mm' : 'UTC'}}</b></h4>
                                        <h5><b>{{Segment.departureCity}} ({{Segment.departure}}) </b></h5>
                                        <h5>{{Segment.departureName}}</h5>
                                    </div>
                                    <div class="flight__separator">
                                        <h5><b>Durasi: </b> {{(Segment.duration)}}</h5>
                                    </div>
                                    <div class="flight__arrival">
                                        <h5>{{Segment.arrivalTime | date: 'dd MMM yyyy' : 'UTC'}}</h5>
                                        <h4><b>{{Segment.arrivalTime | date : 'HH:mm' : 'UTC'}}</b></h4>
                                        <h5><b>{{Segment.arrivalCity}} ({{Segment.arrival}})</b></h5>
                                        <h5>{{Segment.arrivalName}}</h5>
                                    </div><!-- .flight__arrival -->
                                </div><!-- .flight__detail -->
                            </div><!-- .flight__content -->
                        </div><!-- .flight -->
                    </div><!-- .flight-wrapper -->
                </div>

                <div>
                    <div class="flight-title flight-title--return">
                        <div class="flight-info">
                            <h4><b>{{FlightConfig[1].FlightRequest.Trips[0].OriginAirport}}</b> ke <b>{{FlightConfig[1].FlightRequest.Trips[0].DestinationAirport}}</b></h4>
                            <h5>{{FlightConfig[1].FlightRequest.Trips[0].DepartureDate | date: 'EEE, dd MMM yyyy'}}</h5>
                        </div><!-- .flight-info -->
                        <a href="#" class="flight-change" ng-hide="PageConfig.Validating"><span ng-click="FlightFunctions.SetActiveFlight('return',-1); FlightFunctions.ResetValidation(); SetOverlay(); SetSection('return')">GANTI</span></a>
                    </div><!-- .flight-title -->

                    <div class="flight-notice" ng-show="FlightConfig[1].FlightValidated && !FlightConfig[1].FlightAvailable">
                        <div class="fare-changed" ng-show="FlightConfig[1].FlightNewPrice">Harga berubah menjadi <b>Rp {{FlightConfig[1].FlightList[ FlightConfig[1].ActiveFlight ].TotalFare | number}}</b></div>
                        <div class="fare-unavailable" ng-hide="FlightConfig[1].FlightNewPrice">Penerbangan tidak tersedia.</div>
                    </div><!-- .flight-notice -->

                    <div class="flight-wrapper" ng-repeat="Segment in FlightConfig[1].FlightList[ FlightConfig[1].ActiveFlight ].Trips[0].Segments track by $index">
                        <div class="transit" ng-if="$index > 0">
                            <span>Transit di {{Segment.departureCity}} ({{Segment.departure}}) selama <b>{{msToTime(FlightConfig[1].FlightList[FlightConfig[0].DetailFlight].trips[0].transits[$index-1].duration) | date : 'HH:mm'}}</b></span>
                        </div><!-- .transit -->
                        <div class="flight">
                            <div class="flight__number">
                                <span>{{$index + 1}}</span>
                            </div><!-- .flight__number-->
                            <div class="flight__content">
                                <div class="flight__summary">
                                    <img ng-src="{{Segment.airlineLogoUrl}}" alt="{{Segment.airlineName}}" class="flight__image" />
                                    <div class="flight__airline">
                                        <h4><b>{{Segment.airlineName}}</b></h4>
                                        <h5>{{Segment.airlineCd}}-{{Segment.flightNo}}</h5>
                                    </div>
                                </div><!-- .flight__summary -->
                                <div class="flight__detail">
                                    <div class="flight__departure">
                                        <h5>{{Segment.departureTime | date: 'dd MMM yyyy' : 'UTC'}}</h5>
                                        <h4><b>{{Segment.departureTime | date : 'HH:mm' : 'UTC'}}</b></h4>
                                        <h5><b>({{Segment.departureAirport}}) {{Segment.departure}}</b></h5>
                                        <h5>{{Segment.departureName}}</h5>
                                    </div>
                                    <div class="flight__separator">
                                        <h5><b>Durasi: </b> {{(Segment.duration)}}</h5>
                                    </div>
                                    <div class="flight__arrival">
                                        <h5>{{Segment.arrivalTime | date: 'dd MMM yyyy' : 'UTC'}}</h5>
                                        <h4><b>{{Segment.arrivalTime | date : 'HH:mm' : 'UTC'}}</b></h4>
                                        <h5><b>{{Segment.arrivalCity}} ({{Segment.arrival}})</b></h5>
                                        <h5>{{Segment.arrivalName}}</h5>
                                    </div>
                                </div><!-- .flight__detail-->
                            </div><!-- .flight-content -->
                        </div><!-- .flight -->
                    </div><!-- .flight-wrapper -->
                </div>

            </section><!-- .overlay__content -->
            <footer class="overlay__footer">
                <div class="container_new">
                    <div class="row1">
                        <div class="col-xs-6">
                            <h5>Harga Total:</h5>
                            <h4 ng-hide="( (FlightConfig[0].FlightValidated && !FlightConfig[0].FlightAvailable && !FlightConfig[0].FlightNewPrice) || (FlightConfig[1].FlightValidated && !FlightConfig[1].FlightAvailable && !FlightConfig[1].FlightNewPrice) )"><b>Rp {{FlightConfig[0].FlightList[ FlightConfig[0].ActiveFlight ].totalFare + FlightConfig[1].FlightList[ FlightConfig[1].ActiveFlight ].totalFare | number}}</b></h4>
                            <h4 ng-show="( (FlightConfig[0].FlightValidated && !FlightConfig[0].FlightAvailable && !FlightConfig[0].FlightNewPrice) || (FlightConfig[1].FlightValidated && !FlightConfig[1].FlightAvailable && !FlightConfig[1].FlightNewPrice) )"><b>Unavailable</b></h4>
                            <h6>*Harga Sudah Termasuk Pajak dan Service Charges</h6>
                        </div>
                        <div class="col-xs-6">
                            <button ng-click="FlightFunctions.Revalidate(FlightConfig[0].ActiveFlight, FlightConfig[1].ActiveFlight)" class="btn btn-yellow btn-block" ng-disabled="(PageConfig.Validating || ((FlightConfig[0].FlightValidated && !FlightConfig[0].FlightAvailable && !FlightConfig[0].FlightNewPrice) || (FlightConfig[1].FlightValidated && !FlightConfig[1].FlightAvailable && !FlightConfig[1].FlightNewPrice) ) )">{{PageConfig.Validating ? 'MEMVALIDASI' : 'PESAN'}}</button>
                        </div>
                    </div>
                </div>
            </footer><!-- .overlay__footer -->
        </div>


        <!-- overlay - filter -->
        <div class="overlay overlay--flight-filter overlay--theme--blue" ng-class="{'active' : (PageConfig.ActiveOverlay == 'flight-filter-departure')}">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    FILTER PENERBANGAN
                    <span class="overlay__close" ng-click="SetOverlay()">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <div class="filter-group filter-group--price">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Harga</h4>
                    </div>
                    <div class="filter-group__content">
                        <div class="slider departure-price-slider" id="departure-price-slider"></div>
                        <div class="slider-minmax">
                            <span>Rp {{FlightConfig[0].FlightFilter.Price.current[0] | number}}</span>
                            <span class="pull-right">Rp {{FlightConfig[0].FlightFilter.Price.current[1] | number}}</span>
                        </div>
                        <div class="hidden">
                            <input type="text" name="priceSliderValueMin" value="" class="departure-price-slider-min" ng-model="FlightConfig[0].FlightFilter.Price.current[0]" />
                            <input type="text" name="priceSliderValueMax" value="" class="departure-price-slider-max" ng-model="FlightConfig[0].FlightFilter.Price.current[1]" />
                        </div>
                    </div>
                </div>
                <div class="filter-group filter-group--transit">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Transit</h4>
                    </div>
                    <div class="filter-group__content">
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.Transit[0]}">
                            <div class="switch"></div>
                            <span>Langsung</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.Transit[0]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.Transit[1]}">
                            <div class="switch"></div>
                            <span>1 Stop</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.Transit[1]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.Transit[2]}">
                            <div class="switch"></div>
                            <span>2 atau lebih</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.Transit[2]" />
                        </label>
                    </div>
                </div>
                <div class="filter-group filter-group--departure">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Jam Berangkat</h4>
                    </div>
                    <div class="filter-group__content">
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.DepartureTime[0]}">
                            <div class="switch"></div>
                            <span>Pagi<br />(04.00 - 11:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.DepartureTime[0]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.DepartureTime[1]}">
                            <div class="switch"></div>
                            <span>Siang<br />(11.00 - 15:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.DepartureTime[1]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.DepartureTime[2]}">
                            <div class="switch"></div>
                            <span>Sore<br />(15.00 - 19:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.DepartureTime[2]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.DepartureTime[3]}">
                            <div class="switch"></div>
                            <span>Malam<br />(19.00 - 04:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.DepartureTime[3]" />
                        </label>
                    </div>
                </div>
                <div class="filter-group filter-group--arrival">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Jam Tiba</h4>
                    </div>
                    <div class="filter-group__content">
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.ArrivalTime[0]}">
                            <div class="switch"></div>
                            <span>Pagi<br />(04.00 - 11:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.ArrivalTime[0]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.ArrivalTime[1]}">
                            <div class="switch"></div>
                            <span>Siang<br />(11.00 - 15:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.ArrivalTime[1]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.ArrivalTime[2]}">
                            <div class="switch"></div>
                            <span>Sore<br />(15.00 - 19:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.ArrivalTime[2]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[0].FlightFilter.ArrivalTime[3]}">
                            <div class="switch"></div>
                            <span>Malam<br />(19.00 - 04:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[0].FlightFilter.ArrivalTime[3]" />
                        </label>
                    </div>
                </div>
                <div class="filter-group filter-group--airline">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Maskapai</h4>
                    </div>
                    <div class="filter-group__content">
                        <label ng-repeat="Airline in FlightConfig[0].FlightFilter.Airline" ng-class="{'active' : !Airline.Checked}">
                            <div class="switch"></div>
                            <span><img ng-src="{{Airline.logoUrl}}" alt="{{Airline.name}}" /> {{Airline.name}}</span>
                            <input type="checkbox" value="false" ng-model="Airline.Checked" ng-change="FlightFiltering.AirlineCheck('departure')" />
                        </label>
                    </div>
                </div>
            </section><!-- .overlay__content -->
        </div><!-- .overlay--flight-filter -->
        <!-- .overlay - sort -->
        <div class="overlay overlay--flight-sort overlay--theme--blue" ng-class="{'active' : (PageConfig.ActiveOverlay == 'flight-sort-departure')}">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    SORTIR PENERBANGAN
                    <span class="overlay__close" ng-click="SetOverlay()">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'price' && FlightConfig[0].FlightSort.Invert == false}" ng-click="FlightConfig[0].FlightSort.Set('price',false)">Harga - Rendah ke Tinggi</span>
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'price' && FlightConfig[0].FlightSort.Invert == true}" ng-click="FlightConfig[0].FlightSort.Set('price',true)">Harga - Tinggi ke Rendah</span>
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'airline' && FlightConfig[0].FlightSort.Invert == false}" ng-click="FlightConfig[0].FlightSort.Set('airline',false)"> Nama Maskapai - A ke Z</span>
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'airline' && FlightConfig[0].FlightSort.Invert == true}" ng-click="FlightConfig[0].FlightSort.Set('airline',true)">Nama Maskapai - Z ke A</span>
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'duration' && FlightConfig[0].FlightSort.Invert == false}" ng-click="FlightConfig[0].FlightSort.Set('duration',false)">Durasi - Singkat ke Lama</span>
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'duration' && FlightConfig[0].FlightSort.Invert == true}" ng-click="FlightConfig[0].FlightSort.Set('duration',true)">Durasi - Lama ke Singkat</span>
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'departure' && FlightConfig[0].FlightSort.Invert == false}" ng-click="FlightConfig[0].FlightSort.Set('departure',false)">Waktu Berangkat - Terawal ke Terakhir</span>
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'departure' && FlightConfig[0].FlightSort.Invert == true}" ng-click="FlightConfig[0].FlightSort.Set('departure',true)">Waktu Berangkat - Terakhir ke Terawal</span>
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'arrival' && FlightConfig[0].FlightSort.Invert == false}" ng-click="FlightConfig[0].FlightSort.Set('arrival',false)">Waktu Kedatangan - Terawal ke Terakhir</span>
                <span ng-class="{'active' : FlightConfig[0].FlightSort.Label == 'arrival' && FlightConfig[0].FlightSort.Invert == true}" ng-click="FlightConfig[0].FlightSort.Set('arrival',true)">Waktu Kedatangan - Terakhir ke Terawal</span>
            </section>
        </div><!-- .overlay--flight-sort -->
        <!-- overlay - filter -->
        <div class="overlay overlay--flight-filter overlay--theme--blue" ng-class="{'active' : (PageConfig.ActiveOverlay == 'flight-filter-return')}">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    FILTER PENERBANGAN
                    <span class="overlay__close" ng-click="SetOverlay()">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <div class="filter-group filter-group--price">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Harga</h4>
                    </div>
                    <div class="filter-group__content">
                        <div class="slider return-price-slider" id="return-price-slider"></div>
                        <div class="slider-minmax">
                            <span>Rp {{FlightConfig[1].FlightFilter.Price.current[0] | number}}</span>
                            <span class="pull-right">Rp {{FlightConfig[1].FlightFilter.Price.current[1] | number}}</span>
                        </div>
                        <div class="hidden">
                            <input type="text" name="priceSliderValueMin" value="" class="return-price-slider-min" ng-model="FlightConfig[1].FlightFilter.Price.current[0]" />
                            <input type="text" name="priceSliderValueMax" value="" class="return-price-slider-max" ng-model="FlightConfig[1].FlightFilter.Price.current[1]" />
                        </div>
                        
                    </div>
                </div>
                <div class="filter-group filter-group--transit">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Transit</h4>
                    </div>
                    <div class="filter-group__content">
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.Transit[0]}">
                            <div class="switch"></div>
                            <span>Langsung</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.Transit[0]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.Transit[1]}">
                            <div class="switch"></div>
                            <span>1 Stop</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.Transit[1]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.Transit[2]}">
                            <div class="switch"></div>
                            <span>2 atau lebih</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.Transit[2]" />
                        </label>
                    </div>
                </div>
                <div class="filter-group filter-group--departure">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Jam Berangkat</h4>
                    </div>
                    <div class="filter-group__content">
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.DepartureTime[0]}">
                            <div class="switch"></div>
                            <span>Pagi<br />(04.00 - 11:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.DepartureTime[0]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.DepartureTime[1]}">
                            <div class="switch"></div>
                            <span>Siang<br />(11.00 - 15:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.DepartureTime[1]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.DepartureTime[2]}">
                            <div class="switch"></div>
                            <span>Sore<br />(15.00 - 19:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.DepartureTime[2]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.DepartureTime[3]}">
                            <div class="switch"></div>
                            <span>Malam<br />(19.00 - 04:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.DepartureTime[3]" />
                        </label>
                    </div>
                </div>
                <div class="filter-group filter-group--arrival">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Jam Tiba</h4>
                    </div>
                    <div class="filter-group__content">
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.ArrivalTime[0]}">
                            <div class="switch"></div>
                            <span>Pagi<br />(04.00 - 11:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.ArrivalTime[0]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.ArrivalTime[1]}">
                            <div class="switch"></div>
                            <span>Siang<br />(11.00 - 15:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.ArrivalTime[1]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.ArrivalTime[2]}">
                            <div class="switch"></div>
                            <span>Sore<br />(15.00 - 19:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.ArrivalTime[2]" />
                        </label>
                        <label ng-class="{'active' : FlightConfig[1].FlightFilter.ArrivalTime[3]}">
                            <div class="switch"></div>
                            <span>Malam<br />(19.00 - 04:00)</span>
                            <input type="checkbox" value="false" ng-model="FlightConfig[1].FlightFilter.ArrivalTime[3]" />
                        </label>
                    </div>
                </div>
                <div class="filter-group filter-group--airline">
                    <div class="filter-group__header">
                        <h4 class="filter-group__title">Berdasarkan Maskapai</h4>
                    </div>
                    <div class="filter-group__content">
                        <label ng-repeat="Airline in FlightConfig[1].FlightFilter.Airline" ng-class="{'active' : !Airline.Checked}">
                            <div class="switch"></div>
                            <span><img ng-src="{{Airline.logoUrl}}" alt="{{Airline.name}}" /> {{Airline.name}}</span>
                            <input type="checkbox" value="false" ng-model="Airline.Checked" ng-change="FlightFiltering.AirlineCheck('return')" />
                        </label>
                    </div>
                </div>
            
               
            </section><!-- .overlay__content -->
        </div><!-- .overlay--flight-filter -->
        <!-- .overlay - sort -->
        <div class="overlay overlay--flight-sort overlay--theme--blue" ng-class="{'active' : (PageConfig.ActiveOverlay == 'flight-sort-return')}">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    SORTIR PENERBANGAN
                    <span class="overlay__close" ng-click="SetOverlay()">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'price' && FlightConfig[1].FlightSort.Invert == false}" ng-click="FlightConfig[1].FlightSort.Set('price',false)">Harga - Rendah ke Tinggi</span>
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'price' && FlightConfig[1].FlightSort.Invert == true}" ng-click="FlightConfig[1].FlightSort.Set('price',true)">Harga - Tinggi ke Rendah</span>
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'airline' && FlightConfig[1].FlightSort.Invert == false}" ng-click="FlightConfig[1].FlightSort.Set('airline',false)"> Nama Maskapai - A ke Z</span>
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'airline' && FlightConfig[1].FlightSort.Invert == true}" ng-click="FlightConfig[1].FlightSort.Set('airline',true)">Nama Maskapai - Z ke A</span>
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'duration' && FlightConfig[1].FlightSort.Invert == false}" ng-click="FlightConfig[1].FlightSort.Set('duration',false)">Durasi - Singkat ke Lama</span>
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'duration' && FlightConfig[1].FlightSort.Invert == true}" ng-click="FlightConfig[1].FlightSort.Set('duration',true)">Durasi - Lama ke Singkat</span>
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'departure' && FlightConfig[1].FlightSort.Invert == false}" ng-click="FlightConfig[1].FlightSort.Set('departure',false)">Waktu Berangkat - Terawal ke Terakhir</span>
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'departure' && FlightConfig[1].FlightSort.Invert == true}" ng-click="FlightConfig[1].FlightSort.Set('departure',true)">Waktu Berangkat - Terakhir ke Terawal</span>
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'arrival' && FlightConfig[1].FlightSort.Invert == false}" ng-click="FlightConfig[1].FlightSort.Set('arrival',false)">Waktu Kedatangan - Terawal ke Terakhir</span>
                <span ng-class="{'active' : FlightConfig[1].FlightSort.Label == 'arrival' && FlightConfig[1].FlightSort.Invert == true}" ng-click="FlightConfig[1].FlightSort.Set('arrival',true)">Waktu Kedatangan - Terakhir ke Terawal</span>
            </section>
        </div><!-- .overlay--flight-sort -->
        <!-- .overlay - change flight -->
        <div class="overlay overlay--theme--blue overlay--flight-form" ng-class="{'active' : (PageConfig.ActiveOverlay == 'flight-form')}">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    <b>GANTI PENERBANGAN</b>
                    <span class="overlay__close" ng-click="SetOverlay()">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <form class="form form-horizontal" ng-submit="FlightSearchForm.Submit()">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-xs-6">
                                <label><b>Pulang Pergi ?</b></label>
                            </div>
                            <div class="col-xs-6 text-right">
                                <label class="flight-trip" ng-class="{'active' : FlightSearchForm.Trip == 'false'}"><input type="radio" name="roundtrip" value="false" ng-model="FlightSearchForm.Trip" class="hidden" />Tidak</label>
                                <label class="flight-trip" ng-class="{'active' : FlightSearchForm.Trip == 'true'}"><input type="radio" name="roundtrip" value="true" ng-model="FlightSearchForm.Trip" class="hidden" />Ya</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <p class="form-control form-origin" ng-click="FlightSearchForm.AutoComplete.Reset('departure');SetOverlay('airport-select')"
                           ng-init="FlightSearchForm.AirportOrigin.City = '@originCityNames[0]'; FlightSearchForm.AirportOrigin.Code = '@trips[0].OriginAirport'">
                            {{FlightSearchForm.AirportOrigin.City}} ({{FlightSearchForm.AirportOrigin.Code}})
                        </p>
                    </div>
                    <div class="form-group">
                        <p class="form-control form-destination" ng-click="FlightSearchForm.AutoComplete.Reset('return');SetOverlay('airport-select')"
                           ng-init="FlightSearchForm.AirportDestination.City = '@destinationCityNames[0]'; FlightSearchForm.AirportDestination.Code = '@trips[0].DestinationAirport'">
                            {{FlightSearchForm.AirportDestination.City}} ({{FlightSearchForm.AirportDestination.Code}})
                        </p>
                    </div>
                    <div class="form-group">
                        <p class="form-control form-date form-departure-date" ng-click="DatePicker.SetOption({Target: 'departure'}); SetOverlay('datepicker-departure')"
                           ng-init="FlightSearchForm.DepartureDate = '@trips[0].DepartureDate.ToString("ddd, d MMM yyyy")'">
                            <b>Berangkat : </b> {{FlightSearchForm.DepartureDate | date: 'EEE, d MMM yyyy'}}
                        </p>
                        <input type="text" value="" ng-model="FlightSearchForm.DepartureDate" class="flight-search-form-departure hidden" />
                    </div>
                    <div class="form-group" ng-hide="FlightSearchForm.Trip == 'false'">
                        <p class="form-control form-date form-return-date" ng-click="DatePicker.SetOption({Target: 'return'}); SetOverlay('datepicker-departure')"
                           ng-init="FlightSearchForm.ReturnDate = '@trips[1].DepartureDate.ToString("ddd, d MMM yyyy")'">
                            <b>Kembali: </b> {{FlightSearchForm.ReturnDate | date : 'EEE, d MMM yyyy'}}
                        </p>
                        <input type="text" value="" ng-model="FlightSearchForm.ReturnDate" class="flight-search-form-return hidden" />
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-xs-4">
                                <p class="form-control form-passenger form-adult" ng-click="FlightSearchForm.PassengerPicker.Reset('adult'); SetOverlay('passenger-select')"
                                   ng-init="FlightSearchForm.Passenger[0] = @data.AdultCount">{{FlightSearchForm.Passenger[0]}}</p>
                            </div>
                            <div class="col-xs-4">
                                <p class="form-control form-passenger form-children" ng-click="FlightSearchForm.PassengerPicker.Reset('children'); SetOverlay('passenger-select')"
                                   ng-init="FlightSearchForm.Passenger[1] = @data.ChildCount">{{FlightSearchForm.Passenger[1]}}</p>
                            </div>
                            <div class="col-xs-4">
                                <p class="form-control form-passenger form-infant" ng-click="FlightSearchForm.PassengerPicker.Reset('infant'); SetOverlay('passenger-select')"
                                   ng-init="FlightSearchForm.Passenger[2] = @data.InfantCount">{{FlightSearchForm.Passenger[2]}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="hidden">

                    </div>
                    <div class="form-group form__flightclass">
                        <select class="form-control" name="cabinclass" ng-model="FlightSearchForm.Cabin" ng-init="FlightSearchForm.Cabin = flightclass[0].value">
                            <option ng-repeat="cabin in flightclass" value="{{cabin.value}}">{{cabin.name}}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-yellow text-center btn-block btn-lg">CARI</button>
                    </div>
                </form>
                <form class="hidden">
                    <div class="form-group origin">
                        <input type="text" value="" class="form-control" placeholder="Asal" />
                    </div>
                    <div class="form-group destination">
                        <input type="text" value="" class="form-control" placeholder="Tujuan" />
                    </div>
                    <div class="form-group departure">
                        <input type="text" value="" class="form-control" placeholder="Tanggal Pergi" />
                    </div>
                    <div class="form-group switch-wrapper">
                        <span>Pulang Pergi?</span>
                        <div class="switch">
                            <label class="control-label active">Ya</label>
                            <label class="control-label">Tidak</label>
                        </div>
                    </div>
                    <div class="form-group return">
                        <input type="text" value="" class="form-control" placeholder="Tanggal Pulang" />
                    </div>
                    <div class="form-group passenger">
                        <input type="text" value="" class="form-control" placeholder="Penumpang" />
                    </div>
                    <div class="form-group submit">
                        <button class="btn btn-yellow btn-block" ng-click="SetOverlay()">CARI PENERBANGAN</button>
                    </div>
                </form>
            </section><!-- .overlay__content -->
        </div><!-- .overlay--flight-form-->
        <!-- overlay airport selector -->
        <div class="overlay overlay--theme--blue overlay--airport-select" ng-class="{'active' : (PageConfig.ActiveOverlay == 'airport-select')}">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    <small>PILIH TUJUAN PENERBANGAN</small>
                    <span class="overlay__close" ng-click="PageConfig.SetOverlay('flight-form')">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">

                <div class="autocomplete-input">
                    <input type="text" class="form-control" name="name" value="" placeholder="Masukan lokasi tujuan penerbangan" ng-model="FlightSearchForm.AutoComplete.Keyword" ng-change="FlightSearchForm.AutoComplete.GetAirport()" />
                </div><!-- .autocomplete-input -->

                <div class="autocomplete-preload" ng-show="FlightSearchForm.AutoComplete.Keyword.length < FlightSearchForm.AutoComplete.MinLength">
                    <div class="list__header">
                        <h4>POPULAR DESTINATION</h4>
                    </div>
                    <ul class="result">
                        <li class="airport" ng-repeat="result in PageConfig.PopularDestination.Popular">
                            <a class="airport__link" ng-click="FlightSearchForm.AutoComplete.SetAirport( FlightSearchForm.AutoComplete.Target , result); PageConfig.SetOverlay()"></a>
                            <span class="airport__code">{{result.Code}}</span>
                            <div class="airport__detail">
                                <p class="airport__location">{{result.City}}, {{result.Country}}</p>
                                <p class="airport__name">{{result.Name}}</p>
                            </div>
                        </li>
                    </ul>
                    <div class="list__header">
                        <h4>INDONESIA</h4>
                    </div>
                    <ul class="result">
                        <li class="airport" ng-repeat="result in PageConfig.PopularDestination.Indonesia">
                            <a class="airport__link" ng-click="FlightSearchForm.AutoComplete.SetAirport( FlightSearchForm.AutoComplete.Target , result); PageConfig.SetOverlay()"></a>
                            <span class="airport__code">{{result.Code}}</span>
                            <div class="airport__detail">
                                <p class="airport__location">{{result.City}}, {{result.Country}}</p>
                                <p class="airport__name">{{result.Name}}</p>
                            </div>
                        </li>
                    </ul>
                    <div class="list__header">
                        <h4>ASIA TENGGARA</h4>
                    </div>
                    <ul class="result">
                        <li class="airport" ng-repeat="result in PageConfig.PopularDestination.SouthEastAsia">
                            <a class="airport__link" ng-click="FlightSearchForm.AutoComplete.SetAirport( FlightSearchForm.AutoComplete.Target , result); PageConfig.SetOverlay()"></a>
                            <span class="airport__code">{{result.Code}}</span>
                            <div class="airport__detail">
                                <p class="airport__location">{{result.City}}, {{result.Country}}</p>
                                <p class="airport__name">{{result.Name}}</p>
                            </div>
                        </li>
                    </ul>
                    <div class="list__header">
                        <h4>ASIA TIMUR</h4>
                    </div>
                    <ul class="result">
                        <li class="airport" ng-repeat="result in PageConfig.PopularDestination.EastAsia">
                            <a class="airport__link" ng-click="FlightSearchForm.AutoComplete.SetAirport( FlightSearchForm.AutoComplete.Target , result); PageConfig.SetOverlay()"></a>
                            <span class="airport__code">{{result.Code}}</span>
                            <div class="airport__detail">
                                <p class="airport__location">{{result.City}}, {{result.Country}}</p>
                                <p class="airport__name">{{result.Name}}</p>
                            </div>
                        </li>
                    </ul>
                    <div class="list__header">
                        <h4>EROPA</h4>
                    </div>
                    <ul class="result">
                        <li class="airport" ng-repeat="result in PageConfig.PopularDestination.Europe">
                            <a class="airport__link" ng-click="FlightSearchForm.AutoComplete.SetAirport( FlightSearchForm.AutoComplete.Target , result); PageConfig.SetOverlay()"></a>
                            <span class="airport__code">{{result.Code}}</span>
                            <div class="airport__detail">
                                <p class="airport__location">{{result.City}}, {{result.Country}}</p>
                                <p class="airport__name">{{result.Name}}</p>
                            </div>
                        </li>
                    </ul>
                    <div class="list__header">
                        <h4>OSEANIA</h4>
                    </div>
                    <ul class="result">
                        <li class="airport" ng-repeat="result in PageConfig.PopularDestination.Oceania">
                            <a class="airport__link" ng-click="FlightSearchForm.AutoComplete.SetAirport( FlightSearchForm.AutoComplete.Target , result); PageConfig.SetOverlay()"></a>
                            <span class="airport__code">{{result.Code}}</span>
                            <div class="airport__detail">
                                <p class="airport__location">{{result.City}}, {{result.Country}}</p>
                                <p class="airport__name">{{result.Name}}</p>
                            </div>
                        </li>
                    </ul>
                    <div class="list__header">
                        <h4>DESTINASI LAINNYA</h4>
                    </div>
                    <ul class="result">
                        <li class="airport" ng-repeat="result in PageConfig.PopularDestination.Others">
                            <a class="airport__link" ng-click="FlightSearchForm.AutoComplete.SetAirport( FlightSearchForm.AutoComplete.Target , result); PageConfig.SetOverlay()"></a>
                            <span class="airport__code">{{result.Code}}</span>
                            <div class="airport__detail">
                                <p class="airport__location">{{result.City}}, {{result.Country}}</p>
                                <p class="airport__name">{{result.Name}}</p>
                            </div>
                        </li>
                    </ul>

                </div><!-- .autocomplete-preload -->

                <div class="autocomplete-loading" ng-show="FlightSearchForm.AutoComplete.Loading">
                    <h4>Mencari Bandara</h4>
                </div><!-- .autocomplete-loading -->

                <div class="autocomplete-result" ng-hide="FlightSearchForm.AutoComplete.Loading">
                    <ul class="result" ng-show="FlightSearchForm.AutoComplete.Keyword.length >= FlightSearchForm.AutoComplete.MinLength">
                        <li class="airport" ng-repeat="result in FlightSearchForm.AutoComplete.Result">
                            <a class="airport__link" ng-click="FlightSearchForm.AutoComplete.SetAirport( FlightSearchForm.AutoComplete.Target , result); PageConfig.SetOverlay('flight-form')"></a>
                            <span class="airport__code">{{result.Code}}</span>
                            <div class="airport__detail">
                                <p class="airport__location">{{result.City}}, {{result.Country}}</p>
                                <p class="airport__name">{{result.Name}}</p>
                            </div>
                        </li>
                    </ul>
                </div><!-- .autocomplete-result -->
            </section><!-- .overlay__content -->
        </div><!-- .overlay--airport-select -->
        <!-- overlay date picker -->
        <div class="overlay overlay--theme--blue overlay--datepicker overlay--datepicker--departure" ng-class="{ 'active' : (PageConfig.ActiveOverlay == 'datepicker-departure') }">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    <span ng-show="DatePicker.Settings.Target == '.flight-search-form-departure'">Pilih Tanggal Keberangkatan</span>
                    <span ng-show="DatePicker.Settings.Target == '.flight-search-form-return'">Pilih Tanggal Pulang</span>
                    <span class="overlay__close" ng-click="SetOverlay('flight-form')">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <div class="ui-datepicker departure-date"></div>
            </section>
        </div><!-- .overlay--datepicker-->
        <!-- overlay date picker -->
        <div class="overlay overlay--theme--blue overlay--datepicker overlay--datepicker--return" ng-class="{ 'active' : (PageConfig.ActiveOverlay == 'datepicker-return') }">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    Pilih Tanggal Keberangkatan
                    <span class="overlay__close" ng-click="SetOverlay('flight-form')">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <div class="ui-datepicker departure-date"></div>
            </section>
        </div><!-- .overlay--datepicker-->
        <!-- overlay passenger picker -->
        <div class="overlay overlay--theme--blue overlay--passenger-selector" ng-class="{'active' : (PageConfig.ActiveOverlay == 'passenger-select')}">
            <header class="overlay__header">
                <h3 class="overlay__title">
                    Jumlah Penumpang
                    <span class="overlay__close" ng-click="SetOverlay('flight-form')">X</span>
                </h3>
            </header><!-- .overlay__header -->
            <section class="overlay__content">
                <div class="passenger-selector">
                    <div class="passenger-selector__header">
                        <ul>
                            <li><a class="adult" ng-class="{'active' : FlightSearchForm.PassengerPicker.ActiveType == 'adult'}" ng-click="FlightSearchForm.PassengerPicker.Reset('adult')"></a></li>
                            <li><a class="children" ng-class="{'active' : FlightSearchForm.PassengerPicker.ActiveType == 'children'}" ng-click="FlightSearchForm.PassengerPicker.Reset('children')"></a></li>
                            <li><a class="infant" ng-class="{'active' : FlightSearchForm.PassengerPicker.ActiveType == 'infant'}" ng-click="FlightSearchForm.PassengerPicker.Reset('infant')"></a></li>
                        </ul>
                    </div>
                    <div class="passenger-selector__body">
                        <div class="selected">
                            <p ng-show="FlightSearchForm.PassengerPicker.ActiveType == 'adult'">
                                <span class="number">{{FlightSearchForm.Passenger[0]}}</span>
                                <span class="description"><b>Dewasa</b><br />(&gt; 12 Tahun)</span>
                            </p>
                            <p ng-show="FlightSearchForm.PassengerPicker.ActiveType == 'children'">
                                <span class="number">{{FlightSearchForm.Passenger[1]}}</span>
                                <span class="description"><b>Anak</b><br />(2-12 Tahun)</span>
                            </p>
                            <p ng-show="FlightSearchForm.PassengerPicker.ActiveType == 'infant'">
                                <span class="number">{{FlightSearchForm.Passenger[2]}}</span>
                                <span class="description"><b>Bayi</b><br />(&lt; 2 Tahun)</span>
                            </p>
                        </div>
                        <div class="selector" ng-show="FlightSearchForm.PassengerPicker.ActiveType != 'infant'">
                            <span ng-repeat="number in FlightSearchForm.PassengerPicker.List" ng-click="FlightSearchForm.PassengerPicker.Set(number)" ng-class="{'disabled' : (number > (FlightSearchForm.PassengerPicker.TotalMaxPassenger - FlightSearchForm.PassengerPicker.TotalCurrentPassenger) )}">{{number}}</span>
                        </div>
                        <div class="selector" ng-show="FlightSearchForm.PassengerPicker.ActiveType == 'infant'">
                            <span ng-repeat="number in FlightSearchForm.PassengerPicker.List" ng-click="FlightSearchForm.PassengerPicker.Set(number)" ng-class="{'disabled' : (number > (FlightSearchForm.PassengerPicker.TotalMaxPassenger - FlightSearchForm.PassengerPicker.TotalCurrentPassenger) || ( number > FlightSearchForm.Passenger[0] ) )}">{{number}}</span>
                        </div>
                        <div class="note">
                            <p ng-show="FlightSearchForm.PassengerPicker.ActiveType == 'infant'">Jumlah bayi tidak boleh lebih dari jumlah penumpang dewasa</p>
                            <p>Jumlah total penumpang tidak boleh lebih dari 9 orang</p>
                        </div>
                    </div>
                </div>
            </section>
        </div><!-- .overlay--passenger-selector -->
        <!-- popup revalidate -->
        <div class="popup__wrapper popup--revalidate" ng-class="{'active':PageConfig.Validating}">
            <div class="popup">

                <div class="revalidate-image">
                    <img src="/assets/mobile/images/revalidate-plane.png" alt="Revalidating" />
                </div>

                <div class="revalidate-anim">

                </div>

                <p>Sedang Memvalidasi<br />Penerbangan Anda</p>

            </div>
        </div>

        <!-- popup roundtrip selection -->
        <div class="popup__wrapper" ng-class="{'active':PageConfig.ActivePopup == 'roundtrip-return'}">
            <div class="popup">
                <header class="popup__header">
                    <h4 class="popup__title">Penerbangan Pulang Pergi<span ng-click="SetPopup()" class="close-modal pull-right">X</span></h4>
                </header>
                <div class="popup__body">
                    <div class="container_new">
                        <div class="row1">
                            <div class="col-xs-4" style="padding-top:12px;">
                                <img src="/Assets/images/airplane-image.jpg" alt="Airplane" />
                            </div>
                            <div class="col-xs-8">
                                <h5 ng-if="FlightConfig[0].ActiveFlight >= 0">Anda telah memilih penerbangan pergi. <b>Silakan lanjutkan dengan memilih penerbangan pulang</b></h5>
                                <h5 ng-if="FlightConfig[0].ActiveFlight < 0">Anda akan memilih penerbangan pulang.</h5>
                            </div>
                        </div>
                    </div>
                </div>
                <footer class="popup__footer">
                    <div class="container_new">
                        <div class="row1">
                            <div class="col-xs-6">
                                <a ng-click="SetPopup(); SetSection('departure'); SetActiveFlight('departure',-1)" class="btn btn-grey btn-block">KEMBALI</a>
                            </div>
                            <div class="col-xs-6">
                                <a ng-click="SetPopup(); SetSection('return');" class="btn btn-yellow btn-block">LANJUT</a>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div><!-- .modal-wrapper -->
        <!-- popup roundtrip selection -->
        <div class="popup__wrapper" ng-class="{'active':PageConfig.ActivePopup == 'roundtrip-departure'}">
            <div class="popup">
                <header class="popup__header">
                    <h4 class="popup__title">Penerbangan Pulang Pergi<span ng-click="SetPopup()" class="close-modal pull-right">X</span></h4>
                </header>
                <div class="popup__body">
                    <div class="container_new">
                        <div class="row1">
                            <div class="col-xs-4" style="padding-top:12px;">
                                <img src="/Assets/images/airplane-image.jpg" alt="Airplane" />
                            </div>
                            <div class="col-xs-8">
                                <h5 ng-if="FlightConfig[1].ActiveFlight >= 0">Anda telah memilih penerbangan pulang. <b>Silakan lanjutkan dengan memilih penerbangan pergi</b></h5>
                                <h5 ng-if="FlightConfig[1].ActiveFlight < 0">Anda akan memilih penerbangan pergi.</h5>
                            </div>
                        </div>
                    </div>
                </div>
                <footer class="popup__footer">
                    <div class="container_new">
                        <div class="row1">
                            <div class="col-xs-6">
                                <a ng-click="SetPopup(); SetSection('return'); SetActiveFlight('return',-1)" class="btn btn-grey btn-block">KEMBALI</a>
                            </div>
                            <div class="col-xs-6">
                                <a ng-click="SetPopup(); SetSection('departure');" class="btn btn-yellow btn-block">LANJUT</a>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div><!-- .modal-wrapper -->
        <!-- popup expired -->
        <div class="popup__wrapper" ng-class="{'active':PageConfig.ExpiryDate.Expired}">
            <div class="popup">
                <header class="popup__header">
                    <h4 class="popup__title">Pencarian Kadaluarsa</h4>
                </header>
                <div class="popup__body">
                    <div class="container_new">
                        <p>Hasil pencarian Anda kadaluarsa. Silakan klik tombol di bawah untuk kembali ke halaman pencarian.</p>
                    </div>
                </div>
                <div class="popup__footer">
                    <div class="container_new">
                        <div class="row1">
                            <div class="col12 hidden">
                                <a href="/" class="btn btn-block btn-gray">HOME</a>
                            </div>
                            <div class="col12">
                                <button class="btn btn-block btn-yellow" ng-click="PageConfig.RefreshPage()" ng-disabled="PageConfig.Refreshing">KEMBALI</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
