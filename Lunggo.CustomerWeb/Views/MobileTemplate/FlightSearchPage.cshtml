@{
    Layout = "/Views/Shared/_layout_mobile.cshtml";
    ViewBag.Title = "Hotel Search Page";
}

@section PageJavascript{
    <script>
        flightFilter();
    </script>
}

<section class="page flight-search-page" ng-controller="flightController">
    <section class="flight-search-param">
        <div class="param">
            <span><b>Jakarta</b> to <b>Bali</b>, <b>12 Maret 2015</b>, Single Flight</span>
        </div>
        <a href="#" class="change-hotel-param" data-function="toggle" data-target=".flight-search-form-wrapper">CHANGE</a>
        <!-- .flight-search form start -->
        <section class="flight-search-form-wrapper container">
            <form class="search-flight-form form-horizontal" action="/id/flight/SearchResultList">
                <h1><b>FLIGHT</b> SEARCH</h1>
                <div class="form-group">
                    <span class="fa fa-plane col-xs-2"></span>
                    <div class="col-xs-10 col-xs-offset-1">
                        <span class="form-control flight-origin" data-trigger="show-formset" data-target=".flight-origin">Start Here</span>
                    </div>
                </div>
                <div class="form-group">
                    <span class="fa fa-plane col-xs-2"></span>
                    <div class="col-xs-10 col-xs-offset-1">
                        <span class="form-control flight-destination" data-trigger="show-formset" data-target=".flight-destination">Destination</span>
                    </div>
                </div>
                <div class="form-group">
                    <span class="fa fa-calendar col-xs-2"></span>
                    <div class="col-xs-10 col-xs-offset-1">
                        <span class="form-control flight-departure-date" data-trigger="show-formset" data-target=".flight-departure-date">Departure Date</span>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-xs-10 col-xs-offset-1">
                        <span>Roundtrip ?</span>

                        <div class="flighttype-select">
                            <label for="flighttype-return" class="active">
                                <input type="radio" name="flightType" value="RoundTrip" id="flighttype-return" checked /> <span>Yes</span>
                            </label>
                            <label for="flighttype-oneway">
                                <input type="radio" name="flightType" value="OneWay" id="flighttype-oneway" /> <span>No</span>
                            </label>
                        </div>

                    </div>
                </div>
                <div class="form-group">
                    <span class="fa fa-calendar col-xs-2"></span>
                    <div class="col-xs-10 col-xs-offset-1">
                        <span class="form-control flight-return-date" data-trigger="show-formset" data-target=".flight-departure-date">Return Date</span>
                        <span class="form-control flight-oneway hidden">One Way Flight</span>
                    </div>
                </div>
                <div class="form-group">
                    <span class="fa fa-user col-xs-2"></span>
                    <div class="col-xs-10 col-xs-offset-1">
                        <span class="form-control flight-passenger" data-trigger="show-formset" data-target=".flight-passenger"><span class="flight-passenger-adult">1</span> <img src="/Assets/images/adult-icon.png" alt="Adult" /> <span class="flight-passenger-child">0</span> <img src="/Assets/images/child-icon.png" alt="Child" /> <span class="flight-passenger-infant">0</span> <img src="/Assets/images/infant-icon.png" alt="Infant" /></span>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-xs-10 col-xs-offset-1">
                        <input type="text" name="info" value="" class="flight-info hidden" />
                        <input type="submit" class="btn btn-yellow" value="SEARCH">
                    </div>
                </div>
            </form>
        </section><!-- .flight-search-form-wrapper -->
    </section><!-- .flight-serach-param -->
    
    <section class="flight-search-filter">
        <div class="flight-search-trigger">
            <a class="flight-filter-trigger" data-function="toggle" data-target=".flight-filter-wrapper">FILTER</a>
            <a class="flight-sort-trigger" data-function="toggle" data-target=".flight-sort-wrapper">SORT</a>
        </div><!-- .flight-search-filter-trigger -->
        <div class="flight-search-content">
            <div class="flight-filter-wrapper">
                <div class="filter-group filter-transit">
                    <h4 class="filter-title">Filter by Transit:</h4>
                    <div class="filter-content">
                        <label>
                            <input type="checkbox" value="" /> <img src="//placehold.it/50" alt="Alternate Text" /> <span>Direct Flight</span>
                        </label>
                        <label>
                            <input type="checkbox" value="" /> <img src="//placehold.it/50" alt="Alternate Text" /> <span>1 Stop</span>
                        </label>
                        <label>
                            <input type="checkbox" value="" /> <img src="//placehold.it/50" alt="Alternate Text" /> <span>more than 1 stop</span>
                        </label>
                    </div>
                </div>
                <div class="filter-group filter-price">
                    <h4 class="filter-title">by Price:</h4>
                    <div class="filter-content">
                        <div class="price-slider"></div>
                        <div class="slider-text">
                            <br />
                            <span>Min Price</span>
                            <span class="pull-right">Max Price</span>
                        </div>
                        <div class="slider-text">
                            <span>IDR {{flightSearchFilter.prices[0] | number:0}}</span>
                            <span class="pull-right">IDR {{flightSearchFilter.prices[ flightSearchFilter.prices.length-1 ] | number:0}}</span>
                        </div>
                        <input class="price-slider-min hidden" type="text" ng-model="flightSearchFilter.priceFilter[0]" />
                        <input class="price-slider-max hidden" type="text" ng-model="flightSearchFilter.priceFilter[1]" />
                    </div>
                </div>
                <div class="filter-group filter-airline">
                    <h4 class="filter-title">by Airline:</h4>
                    <div class="filter-content">
                        <div>
                            <label class="airline" ng-repeat="airline in flightSearchFilter.airlineList">
                                <input type="checkbox" name="name" value="" />
                                <img ng-src="{{airline.LogoUrl}}" alt="{{airline.Name}}" />
                                <span>{{airline.Name}}</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="filter-group filter-onward">
                    <h4 class="filter-title">by Onward flight time:</h4>
                    <div class="filter-content">
                        <h5>Departure time</h5>
                        <div class="onward-departure-slider"></div>
                        <div class="slider-text">
                            <br />
                            <span>00:00</span>
                            <span class="pull-right">24:00</span>
                        </div>
                        <input class="onward-departure-slider-min hidden" type="text" ng-model="flightSearchFilter.onwardDeparture[0]" />
                        <input class="onward-departure-slider-max hidden" type="text" ng-model="flightSearchFilter.onwardDeparture[1]" />
                        <h5>Arrival time</h5>
                        <div class="onward-arrival-slider"></div>
                        <div class="slider-text">
                            <br />
                            <span>00:00</span>
                            <span class="pull-right">24:00</span>
                        </div>
                        <input class="onward-arrival-slider-min hidden" type="text" ng-model="flightSearchFilter.onwardArrival[0]" />
                        <input class="onward-arrival-slider-max hidden" type="text" ng-model="flightSearchFilter.onwardArrival[1]" />
                    </div>
                </div>
                <div class="filter-group filter-return" ng-if="flightSearchParams.TripType == 'Return'">
                    <h4 class="filter-title">by Return flight time:</h4>
                    <div class="filter-content">
                        <h5>Departure time</h5>
                        <div class="return-departure-slider"></div>
                        <div class="slider-text">
                            <br />
                            <span>00:00</span>
                            <span class="pull-right">24:00</span>
                        </div>
                        <input class="return-departure-slider-min hidden" type="text" ng-model="flightSearchFilter.returnDeparture[0]" />
                        <input class="return-departure-slider-max hidden" type="text" ng-model="flightSearchFilter.returnDeparture[1]" />
                        <h5>Arrival time</h5>
                        <div class="return-arrival-slider"></div>
                        <div class="slider-text">
                            <br />
                            <span>00:00</span>
                            <span class="pull-right">24:00</span>
                        </div>
                        <input class="return-arrival-slider-min hidden" type="text" ng-model="flightSearchFilter.returnArrival[0]" />
                        <input class="return-arrival-slider-max hidden" type="text" ng-model="flightSearchFilter.returnArrival[1]" />
                    </div>
                </div>
            </div><!-- .flight-filter-wrapper -->
            <div class="flight-sort-wrapper">
                <a href="#">by Price - Lowest to Highest</a>
                <a href="#">by Price - Highest to Lowest</a>
                <a href="#">by Duration - Shortest to Longest</a>
                <a href="#">by Duration - Longest to Shortest</a>
                <a href="#">by Departure - Earliest to Latest</a>
                <a href="#">by Departure - Latest to Earliest</a>
                <a href="#">by Arrival - Earliest to Latest</a>
                <a href="#">by Arrival - Latest to Earliest</a>
            </div><!-- .flight-sort-wrapper -->
        </div><!-- .flight-search-content -->
    </section><!-- .flight-search-filter -->
    

    <section class="flight-search-result">
        
        <div class="loading-wrapper" ng-if="!loaded">
            <h1 class="text-center">Fetching Flight</h1>
        </div>

        <div class="flight-wrapper" ng-if="loaded">
            <div class="flight" ng-repeat="flight in flightSearchResult.FlightList">
                <div class="flight-header">
                    <span class="flight-airline"><img ng-src="{{flight.FlightTrips[0].Airlines[0].LogoUrl}}" alt="{{flight.FlightTrips[0].Airlines[0].Name}}" /> {{flight.FlightTrips[0].Airlines[0].Name}}</span>
                    <span class="flight-price pull-right">IDR {{flight.TotalFare | number:0}}</span>
                </div><!-- .flight-header -->
                <div class="flight-content">
                    <div class="flight-origin">
                        <span class="time">{{getDateTime( flight.FlightTrips[0].FlightSegments[0].DepartureTime ) | date: 'dd MMM yyyy' : 'UTC'}}</span>
                        <span class="airport">{{flight.FlightTrips[0].OriginCity}}</span>
                    </div>
                    <div class="flight-destination">
                        <span class="time">{{getDateTime( flight.FlightTrips[0].FlightSegments[(flight.FlightTrips[0].FlightSegments.length-1)].ArrivalTime ) | date: 'dd MMM yyyy' : 'UTC'}}</span>
                        <span class="airport">{{flight.FlightTrips[0].DestinationCity}}</span>
                    </div>
                    <div class="flight-duration">
                        <span class="time">{{flight.FlightTrips[0].TotalDuration}}</span>
                        <span class="transit" ng-if="flight.FlightTrips[0].TotalTransit == 0">Direct Flight</span>
                        <span class="transit" ng-if="flight.FlightTrips[0].TotalTransit > 0">{{flight.FlightTrips[0].TotalTransit}} stop</span>
                    </div>
                </div><!-- .flight-content -->
                <div class="flight-return" ng-if="flightSearchParams.TripType == 'Return'">
                    <div class="flight-header">
                        <span class="flight-airline"><img ng-src="{{flight.FlightTrips[1].Airlines[0].LogoUrl}}" alt="{{flight.FlightTrips[1].Airlines[0].Name}}" /> {{flight.FlightTrips[1].Airlines[0].Name}}</span>
                    </div><!-- .flight-header -->
                    <div class="flight-content">
                        <div class="flight-origin">
                            <span class="time">{{getDateTime( flight.FlightTrips[1].FlightSegments[0].DepartureTime ) | date: 'dd MMM yyyy' : 'UTC'}}</span>
                            <span class="airport">{{flight.FlightTrips[1].OriginCity}}</span>
                        </div>
                        <div class="flight-destination">
                            <span class="time">{{getDateTime( flight.FlightTrips[1].FlightSegments[(flight.FlightTrips[1].FlightSegments.length-1)].ArrivalTime ) | date: 'dd MMM yyyy' : 'UTC'}}</span>
                            <span class="airport">{{flight.FlightTrips[1].DestinationCity}}</span>
                        </div>
                        <div class="flight-duration">
                            <span class="time">{{flight.FlightTrips[1].TotalDuration}}</span>
                            <span class="transit" ng-if="flight.FlightTrips[1].TotalTransit == 0">Direct Flight</span>
                            <span class="transit" ng-if="flight.FlightTrips[1].TotalTransit > 0">{{flight.FlightTrips[1].TotalTransit}} stop</span>
                        </div>
                    </div><!-- .flight-content -->
                </div>
                <a class="flight-link" ng-click="getCtrlScope().flightDetailActive = true; getCtrlScope().flightCurrent = flight.FlightIndex; getCtrlScope().updateActiveFlight()"></a>
            </div><!-- .flight.return-flight -->
        </div>

    </section><!-- .flight-search-result -->
    
    <!-- .flight-detail -->
    <div class="flight-detail" ng-if="flightDetailActive">
        <header class="flight-detail-header">
            <h3>Flight Detail</h3>
            <span class="flight-detail-close fa fa-times" ng-click="getCtrlScope().flightDetailActive = false; getCtrlScope().hideDetailActive();"></span>
        </header><!-- .flight-detail-header -->
        <section class="flight-detail-content">

            <div class="details">
            
                <h1 class="text-center">Flight Detail</h1>
            
                <div class="trip-list onward">
                    <h3 class="text-center">Onward Flight</h3>
                    <span class="trip-general">{{flightCurrentDetail.FlightTrips[0].OriginAirport}} to {{flightCurrentDetail.FlightTrips[0].DestinationAirport}}: {{getDateTime(flightCurrentDetail.FlightTrips[0].DepartureDate) | date: 'dd MMM yyyy' : 'UTC'}}<br/>(Duration:{{flightCurrentDetail.FlightTrips[0].TotalDuration}})</span>
                    <div class="trip" ng-repeat="trip in flightCurrentDetail.FlightTrips[0].FlightSegments">
                        <h5 class="airline-name"><img ng-src="{{trip.AirlineLogoUrl}}" alt="{{trip.AirlineName}}" /> {{trip.AirlineName}} : {{trip.AirlineCode}} {{trip.AircraftCode}} </h5>
                        <div class="trip-wrapper">
                            <div class="trip-origin">
                                <span>Departure</span>
                                <span class="time">{{getDateTime(trip.DepartureTime) | date: 'HH:mm'}}</span>
                                <span class="date">{{getDateTime(trip.DepartureTime) | date: 'dd MMM yyyy' : 'UTC'}}</span>
                                <span class="airport">{{trip.DepartureAirport}}</span>
                                <span class="city">{{trip.DepartureCity}}</span>
                            </div>
                            <div class="trip-destination">
                                <span>Arrival</span>
                                <span class="time">{{getDateTime(trip.ArrivalTime) | date: 'HH:mm'}}</span>
                                <span class="date">{{getDateTime(trip.ArrivalTime) | date: 'dd MMM yyyy' : 'UTC'}}</span>
                                <span class="airport">{{trip.ArrivalAirport}}</span>
                                <span class="city">{{trip.ArrivalCity}}</span>
                            </div>
                            <div class="trip-duration">
                                <span>Duration</span>
                                <span class="time">{{trip.Duration}}</span>
                                <span>{{trip.CabinClass}}</span>
                            </div>
                        </div>
                        <!-- if flight operator is different-->
                        <div class="trip-operator" ng-if=" trip.OperatingAirlineCode != trip.AirlineCode ">
                            <span>This flight is operated by : <img ng-src="{{trip.OperatingAirlineLogoUrl}}" alt="{{trip.OperatingAirlineName}}"/> {{trip.OperatingAirlineName}} </span>
                        </div><!-- .flight-operator -->
                    </div>
                </div>    
                <div class="trip-list return" ng-if="flightSearchParams.TripType == 'Return'">
                    <h3 class="text-center">Return Flight</h3>
                    <span class="trip-general">{{flightCurrentDetail.FlightTrips[1].OriginAirport}} to {{flightCurrentDetail.FlightTrips[1].DestinationAirport}}: {{getDateTime(flightCurrentDetail.FlightTrips[1].DepartureDate) | date: 'dd MMM yyyy' : 'UTC'}}<br/>(Duration:{{flightCurrentDetail.FlightTrips[1].TotalDuration}})</span>
                    <div class="trip" ng-repeat="trip in flightCurrentDetail.FlightTrips[1].FlightSegments">
                        <h5 class="airline-name"><img ng-src="{{trip.AirlineLogoUrl}}" alt="{{trip.AirlineName}}" /> {{trip.AirlineName}} : {{trip.AirlineCode}} {{trip.AircraftCode}} </h5>
                        <div class="trip-wrapper">
                            <div class="trip-origin">
                                <span>Departure</span>
                                <span class="time">{{getDateTime(trip.DepartureTime) | date: 'HH:mm'}}</span>
                                <span class="date">{{getDateTime(trip.DepartureTime) | date: 'dd MMM yyyy' : 'UTC'}}</span>
                                <span class="airport">{{trip.DepartureAirport}}</span>
                                <span class="city">{{trip.DepartureCity}}</span>
                            </div>
                            <div class="trip-destination">
                                <span>Arrival</span>
                                <span class="time">{{getDateTime(trip.ArrivalTime) | date: 'HH:mm'}}</span>
                                <span class="date">{{getDateTime(trip.ArrivalTime) | date: 'dd MMM yyyy' : 'UTC'}}</span>
                                <span class="airport">{{trip.ArrivalAirport}}</span>
                                <span class="city">{{trip.ArrivalCity}}</span>
                            </div>
                            <div class="trip-duration">
                                <span>Duration</span>
                                <span class="time">{{trip.Duration}}</span>
                                <span>{{trip.CabinClass}}</span>
                            </div>
                        </div>
                        <!-- if flight operator is different-->
                        <div class="trip-operator" ng-if=" trip.OperatingAirlineCode != trip.AirlineCode ">
                            <span>This flight is operated by : <img ng-src="{{trip.OperatingAirlineLogoUrl}}" alt="{{trip.OperatingAirlineName}}" /> {{trip.OperatingAirlineName}} </span>
                        </div><!-- .flight-operator -->
                    </div>
                </div>    

            </div><!-- .details -->

        </section><!-- .flight-detail-content -->
        <footer class="flight-detail-footer container">
            <div class="row">
                <div class="col-xs-6 footer-left">
                    <span>Total Fare</span>
                    <h3 class="footer-price">IDR {{flightCurrentDetail.TotalFare | number:0}}</h3>
                    <span>Fee and tax included</span>
                </div>
                <div class="col-xs-6 footer-right">
                    <a href="#" class="btn btn-yellow btn-block-lg">BOOK FLIGHT</a>
                </div>
            </div>
        </footer><!-- .flight-detail-footer -->

    </div><!-- .flight-detail -->

</section><!-- .flight-search-page -->



