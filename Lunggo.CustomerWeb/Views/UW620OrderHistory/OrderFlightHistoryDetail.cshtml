@using System.Globalization
@using Lunggo.ApCommon.Constant
@using Lunggo.ApCommon.Identity.Users
@using Lunggo.ApCommon.Payment.Constant
@using Lunggo.Framework.Extension
@model Lunggo.ApCommon.Flight.Model.FlightReservationForDisplay
@{
    Layout = "/Views/Shared/Travorama20/_Layout20150929.cshtml";
    ViewBag.BodyClass = "page-account page-account-profile";
    ViewBag.Title = "Detail Pemesanan";
    ViewBag.PageActiveSection = "order";
}

@section AdditionalJS{
    <!-- additional Angular JS-->
    <script src="/Assets/js/angular.min.js"></script>
    <script src="/Assets/js/angular-animate.min.js"></script>
    <script src="/Assets/js/angular-route.min.js"></script>
}

@section PageJS{
    <script>
    var langCode = 'en';
    var rsvNo = @Model.RsvNo;
    @*var orderDate = '@Model.RsvTime.ToString("u")';
    //var refundDate = '@(Model.Payment.Refund != null ? Model.Payment.Refund.Time.ToString("u") : "")';*@
    </script>
    <!-- angular controller -->
    <script src="/Assets/travorama20/js/accountController.js"></script>
}


<div class="container page-loading" ng-app="travorama" ng-class="{'page-loaded' : pageLoaded}" ng-controller="orderDetailController">
    <div class="row">

        <div class="col-xs-3">
            @Html.Partial("/Views/Shared/travorama20/_SectionUserMenu.cshtml")
        </div>
        <!-- ******************** -->

        <div class="col-xs-9">
            <section class="account-content">

                <div class="order-detail">
                    <header class="content-header">
                        <h2>ORDER ID : <b>{{flight.rsvNo}}</b></h2>
                    </header>
                    <section class="content-body">

                        <div class="info-buyer">
                            <header>
                                <h4>
                                    <b>BUYER INFO</b>
                                        <button  ng-hide="flight.payment.status == 3" href="@Url.Action("Eticket", "Flight", new {rsvNo = Model.RsvNo})" class="pull-right btn btn-yellow" disabled>@Html.I18NString("CW00198")</button>
                                    <a ng-hide="flight.payment.status != 3" href="@Url.Action("Eticket", "Flight", new {rsvNo = Model.RsvNo})" class="pull-right btn btn-yellow" target="_blank">@Html.I18NString("CW00198")</a>
                                    <a ng-if="flight.payment.method == 2 && flight.payment.status == 2" style="margin-right: 6px;" href="@Url.Action("Confirmation", "Flight", new {rsvNo = Model.RsvNo})" target="_blank" class="pull-right btn btn-yellow">Confirm</a>
                                </h4>
                            </header>
                            <section>
                                <div class="form form-horizontal">
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">User ID</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">{{flight.contact.email}}</p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">Order Name</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">{{flight.contact.name}}</p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">Order Date</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">{{flight.rsvTime | date : 'dd - MMMM - yyyy , HH:mm' :'UTC'}}</p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">Order Type</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">Flight</p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">Order Final Price</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">Rp {{flight.payment.finalPrice | number}}</p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">Payment Method</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">{{methodpayment(flight.payment.method)}}</p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">Payment Status</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">{{paymentstatus(flight.payment.status)}}</p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">@Html.I18NString("CW00017")</label>
                                        <div class="col-xs-9">
                                            <ol class="passenger-list">
                                                <li ng-repeat="passenger in flight.pax track by $index">
                                                    <div class="row">
                                                        <div class="col-xs-9">
                                                            <p>{{title(passenger.title)}} {{passenger.name}}</p>
                                                        </div>
                                                        <div class="col-xs-3">
                                                            <span>{{paxtype(passenger.type)}}</span>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ol>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div><!-- .info-buyer -->

                        <div class="info-flight">
                            <header>
                                <h4><b>@Html.I18NString("CW00199")</b></h4>
                            </header>
                            <section>
                                <div ng-repeat="trip in flight.itin.trips">
                                    <div class="flight departure" ng-if="$index = 0">
                                        <p><!--<img src="{{trip.segments[0].airlineLogoUrl}}" alt="trip.segments[0].airlineName" /> <span>{{trip.segments[0].airlineName}}</span>--> </p>
                                        <div class="row">
                                            <div class="col-xs-2">
                                                <p>Berangkat :</p>
                                            </div>
                                            <div class="col-xs-9">
                                                <p>{{trip.originCity}} - {{trip.destinationCity}}</p>
                                                <p>{{trip.date | date : 'dd MMMM yyyy'}}</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="flight departure" ng-if="$index = 1">
                                        <p><!--<img src="{{trip.segments[0].airlineLogoUrl}}" alt="trip.segments[0].airlineNamme" />--> <span>{{trip.segments[0].airlineName}}</span> </p>
                                        <div class="row">
                                            <div class="col-xs-2">
                                                <p>Berangkat :</p>
                                            </div>
                                            <div class="col-xs-9">
                                                <p>{{trip.originCity}} - {{trip.destinationCity}}</p>
                                                <p>{{trip.date | date : 'dd MMMM yyyy'}}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                    

                            </section>

                        </div><!-- .info-flight -->

                        <div class="refund-detail">
                            <header>
                                <h4><b>@Html.I18NString("CW00199")</b></h4>
                            </header>
                            <section>
                                <div class="form form-horizontal">
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">No Refund</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">
                                                <span ng-show="flight.payment.refund != null">{{flight.payment.refund.amount}}</span>
                                                <span ng-show="flight.payment.refund != null">-</span>
                                            </p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">Tgl Pengajuan</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">
                                                <span>{{flight.payment.refund.Time | date : 'dd - MMMM - yyyy , HH:mm' : 'UTC'}}</span>
                                            </p>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-xs-3">Status Refund</label>
                                        <div class="col-xs-9">
                                            <p class="form-control-static">-</p>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div><!-- .refund-detail -->

                    </section>
                </div><!-- .history-content -->

            </section><!-- .account-content -->
        </div>

    </div>
</div>